| **Inicio**               | **atr谩s 7**                    | **Siguiente 9**                                    |
| ------------------------ | ------------------------------ | -------------------------------------------------- |
| [](../../../README.md) | [](./7.MODELADO_DE_DATOS.md) | [](./9.ENRIQUECIENDO_NUESTRO_MODELO_DE_DATOS.md) |

---

## **ndice**

| Temario                                                                                 |
| --------------------------------------------------------------------------------------- |
| [Obtenci贸n de datos](#obtenci贸n-de-datos)                                               |
| [Transformaci贸n y Limpieza de Datos](#transformaci贸n-y-limpieza-de-datos)               |
| [Carga de modelo de datos](#carga-de-modelo-de-datos)                                   |
| [Uso de Par谩metros](#uso-de-par谩metros)                                                 |
| [Construcci贸n de Calendario con Lenguaje M](#construcci贸n-de-calendario-con-lenguaje-m) |

---

# **8. INTEGRACIN DE DATOS CON POWER QUERY**

---

## **Obtenci贸n de datos**

La obtenci贸n de datos en Power Query es un proceso que permite importar y transformar datos de diferentes fuentes en Power BI. Power Query proporciona una interfaz intuitiva y f谩cil de usar para conectarse a diversas fuentes de datos y realizar operaciones de extracci贸n y transformaci贸n antes de cargar los datos en el modelo de Power BI. A continuaci贸n, se proporciona una explicaci贸n detallada de la obtenci贸n de datos en Power Query con ejemplos:

1. **Conexi贸n a una fuente de datos:**

En Power Query, puedes conectarte a una amplia gama de fuentes de datos, como archivos de Excel, bases de datos relacionales, servicios en la nube, archivos CSV, entre otros. Puedes acceder a la opci贸n "Obtener datos" en la pesta帽a "Inicio" de Power BI para seleccionar la fuente de datos con la que deseas trabajar.

**Ejemplo:** Supongamos que deseas importar datos de un archivo Excel que contiene informaci贸n de ventas. Puedes seleccionar la opci贸n "Desde archivo" y navegar hasta la ubicaci贸n del archivo Excel.

2. **Previsualizaci贸n y selecci贸n de datos:**

Despu茅s de conectarte a la fuente de datos, Power Query te permite previsualizar los datos antes de importarlos. Puedes explorar la estructura de los datos y seleccionar las tablas o columnas espec铆ficas que deseas importar en Power BI.

**Ejemplo:** En el archivo Excel de ventas, puedes previsualizar las hojas de trabajo disponibles y seleccionar la hoja que contiene la informaci贸n relevante, como la tabla de ventas.

3. **Transformaci贸n de datos:**

Power Query ofrece una amplia gama de herramientas de transformaci贸n de datos para limpiar, filtrar y dar formato a los datos importados. Puedes realizar operaciones como eliminar columnas no deseadas, filtrar filas basadas en criterios espec铆ficos, combinar y dividir columnas, cambiar el tipo de datos, entre otros.

**Ejemplo:** Supongamos que en la tabla de ventas importada, hay columnas innecesarias como "Descripci贸n" y "ID de empleado" que deseas eliminar. Puedes usar las herramientas de transformaci贸n de Power Query para eliminar estas columnas.

4. **Aplicaci贸n de pasos de transformaci贸n:**

A medida que realizas las transformaciones en Power Query, los pasos de transformaci贸n se registran en un panel de "Editor de consultas". Esto permite realizar cambios posteriores en los datos y garantizar la reproducibilidad de las transformaciones.

**Ejemplo:** Mientras eliminas las columnas innecesarias, cada paso de eliminaci贸n se registra en el Editor de consultas para que puedas ajustar o deshacer cualquier transformaci贸n en el futuro.

5. **Combinaci贸n de fuentes de datos:**

Power Query tambi茅n te permite combinar datos de m煤ltiples fuentes utilizando operaciones de uni贸n, combinaci贸n o apendizaci贸n. Esto es 煤til cuando deseas combinar datos de diferentes archivos o fuentes de datos relacionadas.

**Ejemplo:** Si tienes un archivo CSV separado que contiene informaci贸n adicional sobre los productos de ventas, puedes utilizar Power Query para combinarlo con los datos de ventas existentes utilizando una columna com煤n, como el ID del producto.

6. **Actualizaci贸n y carga de datos:**

Una vez que hayas realizado las transformaciones necesarias en Power Query, puedes cargar los datos en el modelo de Power BI. Puedes configurar la programaci贸n de actualizaciones para mantener los datos sincronizados con la fuente de datos subyacente.

**Ejemplo:** Despu茅s de aplicar todas las transformaciones necesarias en Power Query, puedes cargar los datos de ventas en el modelo de Power BI. A partir de ese momento, cada vez que actualices los datos en la fuente de datos original, podr谩s actualizar los datos en Power BI para reflejar los cambios m谩s recientes.

En resumen, la obtenci贸n de datos en Power Query es un proceso flexible y poderoso que te permite conectarte a diversas fuentes de datos, realizar transformaciones, combinar datos y cargarlos en el modelo de Power BI. Esto te brinda la capacidad de obtener y dar forma a los datos de manera eficiente y prepararlos para su an谩lisis y visualizaci贸n en Power BI.

[](#铆ndice)

---

## **Transformaci贸n y Limpieza de Datos**

La transformaci贸n y limpieza de datos es un proceso fundamental en el an谩lisis de datos, que permite preparar los datos para su posterior an谩lisis y visualizaci贸n. Implica realizar una serie de pasos y operaciones para corregir errores, eliminar datos irrelevantes o inconsistentes, estandarizar formatos y estructuras, y agregar o modificar datos seg煤n sea necesario. A continuaci贸n, se proporciona una explicaci贸n detallada de la transformaci贸n y limpieza de datos con ejemplos:

1. **Eliminaci贸n de datos irrelevantes:**

En ocasiones, los datos pueden contener columnas o filas que no son relevantes para el an谩lisis. Estos datos irrelevantes pueden ser eliminados para reducir el tama帽o del conjunto de datos y mejorar la eficiencia del an谩lisis.

**Ejemplo:** Supongamos que tienes un conjunto de datos de ventas que contiene una columna de "N煤mero de factura" que no es relevante para el an谩lisis. Puedes eliminar esta columna utilizando herramientas de transformaci贸n de datos como Power Query.

2. **Correcci贸n de errores y valores faltantes:**

Los datos a menudo contienen errores o valores faltantes que pueden afectar la calidad y precisi贸n del an谩lisis. Es importante corregir o completar estos errores y valores faltantes para asegurar la integridad de los datos.

**Ejemplo:** Si tienes una columna de "Edad" en tu conjunto de datos y encuentras valores negativos o valores faltantes, puedes corregir los valores negativos o completar los valores faltantes utilizando t茅cnicas de transformaci贸n de datos, como reemplazarlos por la media de la edad.

3. **Normalizaci贸n de datos:**

La normalizaci贸n de datos implica estandarizar los formatos y estructuras de los datos para facilitar el an谩lisis. Esto puede incluir la estandarizaci贸n de nombres, la conversi贸n de formatos de fecha y hora, o la eliminaci贸n de caracteres especiales.

**Ejemplo:** Si tienes una columna de "Nombres de clientes" que contiene diferentes variaciones de nombres (por ejemplo, "John Doe", "John R. Doe", "J. Doe"), puedes normalizarlos para que todos los nombres se muestren en un formato consistente utilizando funciones de transformaci贸n de datos.

4. **Agrupaci贸n y agregaci贸n de datos:**

La agrupaci贸n y agregaci贸n de datos permite resumir los datos en niveles superiores o m谩s generales para un an谩lisis m谩s amplio. Esto implica agrupar los datos por una o m谩s columnas y calcular medidas agregadas, como sumas, promedios o recuentos.

**Ejemplo:** Si tienes un conjunto de datos de ventas diarias y deseas analizar las ventas mensuales, puedes agrupar los datos por mes y calcular la suma de las ventas utilizando funciones de agregaci贸n en herramientas de transformaci贸n de datos.

5. **Enriquecimiento de datos:**

A veces, es necesario enriquecer los datos agregando informaci贸n adicional de fuentes externas. Esto puede implicar la combinaci贸n de datos con otras fuentes, como tablas de referencia o datos geoespaciales, para obtener m谩s contexto y mejorar el an谩lisis.

**Ejemplo:** Si tienes datos de clientes que incluyen la ciudad y el pa铆s, puedes enriquecer estos datos agregando informaci贸n demogr谩fica o informaci贸n geoespacial utilizando la combinaci贸n de datos en herramientas de transformaci贸n de datos.

6. **Transformaciones personalizadas:**

En algunos casos, puede ser necesario aplicar transformaciones personalizadas que no est谩n disponibles de forma predeterminada en las herramientas de transformaci贸n de datos. En estos casos, se pueden escribir funciones o scripts personalizados para realizar operaciones espec铆ficas en los datos.

**Ejemplo:** Si deseas realizar una transformaci贸n personalizada en una columna de texto, como extraer los primeros tres caracteres de cada valor, puedes escribir una funci贸n personalizada en un lenguaje de programaci贸n como Python o R y aplicarla en el proceso de transformaci贸n de datos.

En resumen, la transformaci贸n y limpieza de datos es un proceso esencial en el an谩lisis de datos que implica corregir errores, eliminar datos irrelevantes, estandarizar formatos, agregar o modificar datos seg煤n sea necesario, y enriquecer los datos con informaci贸n adicional. Estas operaciones garantizan la calidad, integridad y coherencia de los datos, lo que a su vez facilita un an谩lisis m谩s preciso y confiable.

[](#铆ndice)

---

## **Carga de modelo de datos**

La carga de un modelo de datos en Power Query implica tomar los datos transformados y limpios obtenidos a trav茅s de las operaciones de extracci贸n y transformaci贸n, y cargarlos en el modelo de Power BI para su an谩lisis y visualizaci贸n. A continuaci贸n, se proporciona una explicaci贸n detallada de la carga de un modelo de datos en Power Query con ejemplos:

1. **Revisi贸n y verificaci贸n de los datos transformados:**

Antes de cargar los datos en el modelo de Power BI, es importante revisar y verificar que los datos transformados sean correctos y est茅n completos. Esto implica asegurarse de que todas las operaciones de transformaci贸n se hayan aplicado correctamente y de que no haya errores o valores faltantes que puedan afectar la calidad de los datos.

**Ejemplo:** Despu茅s de aplicar diversas transformaciones en Power Query, como eliminar columnas, corregir valores incorrectos y realizar agregaciones, es importante revisar una muestra de los datos para verificar que los cambios se hayan aplicado correctamente.

2. **Definici贸n del esquema de carga:**

Antes de cargar los datos en el modelo de Power BI, es necesario definir el esquema de carga, que incluye la estructura y las propiedades de las tablas, columnas, relaciones y medidas en el modelo. Esto se puede hacer mediante la configuraci贸n de las propiedades en el Editor de consultas de Power Query.

**Ejemplo:** Al definir el esquema de carga, puedes especificar las relaciones entre las tablas, las columnas que se utilizar谩n como claves primarias o externas, y las medidas que se calcular谩n en el modelo.

3. **Creaci贸n de una tabla de hechos y tablas de dimensiones:**

En un modelo de datos, generalmente se distingue entre una tabla de hechos y tablas de dimensiones. La tabla de hechos contiene los datos num茅ricos y m茅tricas, mientras que las tablas de dimensiones contienen informaci贸n descriptiva que proporciona contexto a los datos de la tabla de hechos. Es importante crear estas tablas de manera adecuada y definir las relaciones entre ellas.

**Ejemplo:** Si est谩s trabajando con datos de ventas, puedes tener una tabla de hechos que contiene las m茅tricas clave como ventas totales, cantidad vendida, etc., y tablas de dimensiones como clientes, productos y fechas.

4. **Configuraci贸n de relaciones:**

Despu茅s de crear las tablas de hechos y dimensiones, es necesario configurar las relaciones entre ellas para establecer c贸mo se relacionan los datos. Esto se puede hacer en el Editor de relaciones de Power Query, donde se pueden especificar las claves primarias y externas para definir las relaciones entre las tablas.

**Ejemplo:** En un modelo de datos de ventas, puedes establecer una relaci贸n entre la tabla de hechos de ventas y la tabla de dimensiones de productos utilizando el ID de producto como clave externa.

5. **Carga de datos en el modelo de Power BI:**

Una vez que se ha realizado la revisi贸n y configuraci贸n adecuada, los datos transformados se pueden cargar en el modelo de Power BI. Esto implica hacer clic en el bot贸n "Cerrar y aplicar" en el Editor de consultas para cargar los datos en Power BI.

**Ejemplo:** Despu茅s de realizar todas las transformaciones y configurar las relaciones, puedes cerrar el Editor de consultas y los datos se cargar谩n en el modelo de Power BI.

6. **Actualizaci贸n de datos:**

Despu茅s de cargar los datos en el modelo de PowerBI, es importante mantener los datos actualizados para reflejar los cambios m谩s recientes en la fuente de datos original. Puedes configurar la programaci贸n de actualizaciones autom谩ticas en Power BI para que los datos se actualicen peri贸dicamente seg煤n la frecuencia que elijas.

**Ejemplo:** Si tus datos de ventas se actualizan diariamente, puedes configurar Power BI para que se actualice autom谩ticamente cada d铆a y asegurarte de que siempre tengas los datos m谩s recientes en tu modelo.

En resumen, la carga de un modelo de datos en Power Query implica revisar y verificar los datos transformados, definir el esquema de carga, crear tablas de hechos y dimensiones, configurar relaciones entre las tablas y cargar los datos en el modelo de Power BI. Al seguir estos pasos, se garantiza que los datos est茅n estructurados y preparados para su an谩lisis y visualizaci贸n en Power BI. Adem谩s, es importante mantener los datos actualizados para asegurar que los an谩lisis reflejen la informaci贸n m谩s reciente.

[](#铆ndice)

---

## **Uso de Par谩metros**

El uso de par谩metros en Power Query permite crear consultas din谩micas y flexibles al permitir la introducci贸n de valores variables en el proceso de transformaci贸n de datos. Los par谩metros pueden ser utilizados para filtrar datos, seleccionar columnas, establecer valores predeterminados y m谩s. A continuaci贸n, se proporciona una explicaci贸n detallada del uso de par谩metros en Power Query con ejemplos:

1. **Creaci贸n de par谩metros:**

En Power Query, puedes crear par谩metros en la pesta帽a "Inicio" utilizando la opci贸n "Gestor de par谩metros". Los par谩metros pueden ser de diferentes tipos, como texto, n煤mero, fecha, entre otros. Puedes asignarles un nombre descriptivo y un valor predeterminado.

**Ejemplo:** Supongamos que deseas crear un par谩metro llamado "A帽o" para filtrar datos por a帽o. Puedes definir el par谩metro con el nombre "A帽o" y asignarle un valor predeterminado de "2022".

2. **Uso de par谩metros en consultas:**

Una vez que hayas creado un par谩metro, puedes utilizarlo en tus consultas de Power Query. Puedes referenciar el par谩metro en las f贸rmulas de transformaci贸n de datos para realizar operaciones basadas en su valor.

**Ejemplo:** Si tienes una columna de fechas en tu conjunto de datos y deseas filtrar los datos por el a帽o seleccionado en el par谩metro "A帽o", puedes agregar una condici贸n de filtro en la consulta utilizando la f贸rmula `"each [Fecha].Year = A帽o"`.

3. **Modificaci贸n de valores de par谩metros:**

Los valores de los par谩metros pueden modificarse en cualquier momento para actualizar los resultados de las consultas. Puedes cambiar los valores directamente en el Gestor de par谩metros o utilizar otras fuentes de datos, como una tabla de Excel o un archivo de texto, para proporcionar valores actualizados.

**Ejemplo:** Si deseas cambiar el valor del par谩metro "A帽o" de "2022" a "2023", puedes editar el valor en el Gestor de par谩metros o cargar un archivo de Excel que contenga la nueva informaci贸n.

4. **Uso de par谩metros en operaciones condicionales:**

Los par谩metros tambi茅n pueden ser utilizados en operaciones condicionales para controlar el flujo de la transformaci贸n de datos. Puedes utilizarlos para establecer reglas y tomar decisiones basadas en los valores de los par谩metros.

**Ejemplo:** Si tienes un par谩metro llamado "Mostrar ventas" con valores "Verdadero" o "Falso", puedes utilizarlo en una operaci贸n condicional para mostrar u ocultar una columna de ventas en funci贸n de la selecci贸n del par谩metro.

5. **Actualizaci贸n de consultas con par谩metros:**

Cuando se actualiza una consulta que utiliza par谩metros, se te solicitar谩 que ingreses los valores correspondientes antes de ejecutar la actualizaci贸n. Esto te permite ajustar los par谩metros seg煤n sea necesario y obtener resultados actualizados.

**Ejemplo:** Si tienes una consulta que filtra los datos por el a帽o seleccionado en el par谩metro "A帽o", cada vez que actualices la consulta se te pedir谩 que ingreses el valor del a帽o antes de ejecutar la actualizaci贸n.

El uso de par谩metros en Power Query proporciona flexibilidad y dinamismo en el proceso de transformaci贸n de datos, permitiendo que los valores sean variables y ajustables seg煤n las necesidadesdel usuario. Esto facilita la creaci贸n de consultas personalizadas y la obtenci贸n de resultados espec铆ficos en funci贸n de los valores de los par谩metros. Los par谩metros permiten automatizar y simplificar el proceso de transformaci贸n de datos al eliminar la necesidad de editar manualmente las f贸rmulas en cada consulta. En cambio, los valores de los par谩metros se pueden ajustar f谩cilmente en un solo lugar, lo que ahorra tiempo y reduce posibles errores.

En resumen, el uso de par谩metros en Power Query es una poderosa funci贸n que permite crear consultas din谩micas y flexibles. Los par谩metros permiten filtrar datos, seleccionar columnas, establecer valores predeterminados y m谩s. Al utilizar par谩metros, se pueden realizar transformaciones personalizadas en los datos de manera eficiente y obtener resultados espec铆ficos basados en valores variables. Esto mejora la capacidad de an谩lisis y visualizaci贸n de datos en Power Query y proporciona mayor flexibilidad y control sobre el proceso de transformaci贸n de datos.

[](#铆ndice)

---

## **Construcci贸n de Calendario con Lenguaje M**

La construcci贸n de un calendario con el lenguaje M en Power Query es 煤til cuando necesitas crear una tabla que contenga todas las fechas de un rango espec铆fico, como un a帽o calendario o un per铆odo de tiempo determinado. El lenguaje M es el lenguaje de f贸rmulas utilizado en Power Query para manipular y transformar datos. A continuaci贸n, se proporciona una explicaci贸n detallada de c贸mo construir un calendario utilizando el lenguaje M con ejemplos:

1. **Crear una nueva consulta:**

En Power Query, crea una nueva consulta utilizando la opci贸n "Desde tabla/rango" en la pesta帽a "Inicio". Se abrir谩 el Editor de consultas, donde podr谩s escribir las f贸rmulas en el lenguaje M.

2. **Definir el rango de fechas:**

Define el rango de fechas para tu calendario. Puedes establecer una fecha de inicio y una fecha de fin para el per铆odo que deseas cubrir. Puedes hacerlo utilizando las funciones de fecha en el lenguaje M, como #date.

**Ejemplo:** Si deseas construir un calendario para el a帽o 2022, puedes establecer una fecha de inicio del 1 de enero de 2022 y una fecha de fin del 31 de diciembre de 2022.

3. **Crear una lista de fechas:**

Utiliza la funci贸n List.Dates para generar una lista de todas las fechas dentro del rango especificado. Esta funci贸n toma la fecha de inicio, la fecha de fin y un paso opcional y genera una lista de fechas en incrementos regulares.

**Ejemplo:** Para generar una lista de todas las fechas en el a帽o 2022, puedes utilizar la f贸rmula: List.Dates(#date(2022, 1, 1), #date(2022, 12, 31), #duration(1, 0, 0, 0))

4. **Transformar la lista en una tabla:**

Convierte la lista de fechas en una tabla utilizando la funci贸n Table.FromList. Esto te permitir谩 dar formato y agregar columnas adicionales a tu calendario.

**Ejemplo:** Para convertir la lista de fechas en una tabla, puedes utilizar la f贸rmula: Table.FromList(#"Lista de fechas", Splitter.SplitByNothing(), null, null, ExtraValues.Error)

5. **Agregar columnas adicionales:**

Si deseas agregar columnas adicionales a tu calendario, como el a帽o, el mes, el trimestre o el d铆a de la semana, puedes utilizar funciones de fecha y hora en el lenguaje M para extraer estas propiedades de cada fecha.

**Ejemplo:** Para agregar una columna de mes a tu calendario, puedes utilizar la f贸rmula: `Table.AddColumn(#"Tabla de fechas", "Mes", each Date.Month([Fecha]))`

6. **Renombrar columnas y eliminar columnas no deseadas:**

Renombra las columnas seg煤n sea necesario para que reflejen correctamente la informaci贸n contenida en ellas. Tambi茅n puedes eliminar columnas que no sean relevantes para tu an谩lisis.

**Ejemplo:** Si deseas renombrar la columna "Fecha" a "FechaCalendario", puedes utilizar la f贸rmula: Table.RenameColumns(#"Tabla de fechas", {{"Fecha", "FechaCalendario"}})

7. **Cargar el resultado en Power BI:**

Finalmente, carga el resultado en Power BI haciendo clic en el bot贸n "Cerrar y aplicar" en el Editor de consultas. Los datos del calendario se cargar谩n en Power BI y estar谩n disponibles para su uso en el modelo de datos y la creaci贸n de visualizaciones.

En resumen, la construcci贸n de un calendario con el lenguaje M en Power Query implica generar una lista de fechas dentro de un rango espec铆fico utilizando la funci贸n List.Dates, convertir la lista en una tabla utilizando Table.FromList, agregar columnas adicionales utilizando funciones de fecha y hora, y finalmente renombrar y eliminar columnas seg煤n sea necesario. Esto te permitir谩 crear un calendario completo con todas las fechas necesarias para tu an谩lisis en Power BI.

[](#铆ndice)

---

| **Inicio**               | **atr谩s 7**                    | **Siguiente 9**                                    |
| ------------------------ | ------------------------------ | -------------------------------------------------- |
| [](../../../README.md) | [](./7.MODELADO_DE_DATOS.md) | [](./9.ENRIQUECIENDO_NUESTRO_MODELO_DE_DATOS.md) |
