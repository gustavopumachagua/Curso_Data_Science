| **Inicio**               | **atr谩s 1**                          | **Siguiente 3**                |
| ------------------------ | ------------------------------------ | ------------------------------ |
| [](../../../README.md) | [](./1.INTRODUCCION_A_POWER_BI.md) | [](./3.MODELADO_DE_DATOS.md) |

---

## **ndice**

| Temario                                                                   |
| ------------------------------------------------------------------------- |
| [Or铆genes de Datos en Power BI](#or铆genes-de-datos-en-power-bi)           |
| [Exploraci贸n de Power Query](#exploraci贸n-de-power-query)                 |
| [Tipos de Conexi贸n](#tipos-de-conexi贸n)                                   |
| [Extracci贸n de datos](#extracci贸n-de-datos)                               |
| [Transformaciones recurrentes](#transformaciones-recurrentes)             |
| [Creaci贸n de columnas condicionales](#creaci贸n-de-columnas-condicionales) |
| [Anexar datos](#anexar-datos)                                             |
| [Fusionar Archivos o Tablas](#fusionar-archivos-o-tablas)                 |
| [Agrupar datos](#agrupar-datos)                                           |
| [Transponer datos](#transponer-datos)                                     |
| [Buenas pr谩cticas en Power Query](#buenas-pr谩cticas-en-power-query)       |

---

# **2. PREPARACIN DE LOS DATOS**

---

## **Or铆genes de Datos en Power BI**

Power BI permite conectar a una amplia variedad de or铆genes de datos para obtener informaci贸n y generar informes y visualizaciones. A continuaci贸n, te proporcionar茅 una explicaci贸n detallada de algunos de los or铆genes de datos comunes en Power BI, junto con ejemplos:

1. **Bases de datos relacionales:** Puedes conectarte a bases de datos relacionales como Microsoft SQL Server, Oracle, MySQL, PostgreSQL, entre otros. Estos or铆genes de datos son ideales para extraer datos estructurados y realizar an谩lisis.

**Ejemplo:** Puedes conectarte a una base de datos de ventas de SQL Server para obtener informaci贸n sobre las transacciones, productos y clientes.

2. **Archivos planos:** Power BI puede conectarse a archivos planos en formatos como CSV (valores separados por comas), Excel, TXT, XML, entre otros. Estos archivos contienen datos estructurados que se pueden importar y analizar en Power BI.

**Ejemplo:** Puedes importar un archivo CSV que contiene datos de ventas por regi贸n y categor铆a de productos.

3. **Servicios en la nube:** Power BI se integra con servicios en la nube populares como Azure SQL Database, Azure Data Lake Storage, SharePoint Online y Dynamics 365. Esto permite acceder a datos almacenados en la nube y realizar an谩lisis en tiempo real.

**Ejemplo:** Puedes conectarte a una base de datos de Azure SQL Database que almacena datos de transacciones de una aplicaci贸n web.

4. **Aplicaciones y servicios web:** Power BI puede conectarse a servicios y aplicaciones web a trav茅s de conectores espec铆ficos. Esto permite obtener datos en tiempo real de servicios como Google Analytics, Salesforce, Dynamics 365, entre otros.

**Ejemplo:** Puedes conectarte a Google Analytics para obtener informaci贸n sobre el rendimiento del sitio web, como el n煤mero de visitantes y las p谩ginas m谩s visitadas.

5. **Fuentes de datos locales:** Power BI tambi茅n puede conectarse a fuentes de datos locales a trav茅s de Gateways de datos locales. Esto permite acceder a datos almacenados en servidores locales y mantener una conexi贸n actualizada con Power BI.

**Ejemplo:** Puedes configurar un Gateway de datos locales para conectarte a una base de datos local de SQL Server y obtener datos de una aplicaci贸n empresarial.

Estos son solo algunos ejemplos de los m煤ltiples or铆genes de datos que se pueden utilizar en Power BI. La capacidad de conectar a diversas fuentes de datos permite reunir informaci贸n de diferentes sistemas y generar informes y visualizaciones en un solo lugar para un an谩lisis integral.

[](#铆ndice)

---

## **Exploraci贸n de Power Query**

La Exploraci贸n de Power Query es una caracter铆stica de Power BI que te permite obtener y transformar datos desde diferentes fuentes para su posterior an谩lisis. Power Query ofrece una interfaz intuitiva y potente para realizar tareas de limpieza, transformaci贸n y modelado de datos. A continuaci贸n, te proporcionar茅 una explicaci贸n detallada de la Exploraci贸n de Power Query con ejemplos:

1. **Obtenci贸n de datos:** Power Query te permite conectarte a diversas fuentes de datos, como bases de datos, archivos planos, servicios en la nube y aplicaciones web. Puedes seleccionar el origen de datos y proporcionar la informaci贸n de conexi贸n necesaria, como la ubicaci贸n de la base de datos o el enlace al archivo.

**Ejemplo:** Puedes conectarte a una base de datos SQL Server y seleccionar la tabla de ventas como origen de datos.

2. **Transformaci贸n de datos:** Una vez que has obtenido los datos, Power Query te permite realizar una amplia variedad de transformaciones para limpiar y dar forma a los datos seg煤n tus necesidades. Puedes filtrar filas, eliminar columnas, cambiar nombres, combinar tablas, dividir columnas, aplicar c谩lculos y mucho m谩s.

**Ejemplo:** Puedes filtrar las ventas solo para un rango de fechas espec铆fico, eliminar columnas irrelevantes como la direcci贸n de env铆o y renombrar la columna "Cantidad" a "Ventas".

3. **Aplicaci贸n de pasos de transformaci贸n:** Power Query registra todas las transformaciones realizadas en una secuencia de pasos. Estos pasos se pueden editar, reordenar o eliminar seg煤n sea necesario. Tambi茅n puedes crear pasos personalizados utilizando el lenguaje de f贸rmulas M de Power Query.

**Ejemplo:** Puedes editar el paso de filtrado de fechas para cambiar el rango de fechas o agregar un paso personalizado para calcular el total de ventas por mes.

4. **Vista previa de los datos transformados:** Power Query te permite visualizar los datos transformados antes de cargarlos en el modelo de datos de Power BI. Esto te ayuda a asegurarte de que los datos se hayan transformado correctamente y sean adecuados para su an谩lisis.

**Ejemplo:** Puedes ver una vista previa de los datos transformados para verificar que las fechas se hayan filtrado correctamente y que las columnas y los c谩lculos sean correctos.

5. **Carga de datos en Power BI:** Una vez que hayas completado las transformaciones necesarias, puedes cargar los datos en el modelo de datos de Power BI para su an谩lisis y visualizaci贸n. Los datos transformados estar谩n disponibles para crear informes y paneles interactivos.

**Ejemplo:** Puedes cargar los datos de ventas transformados en Power BI y utilizarlos para crear gr谩ficos y visualizaciones que muestren el rendimiento de ventas por categor铆a de productos.

En resumen, la Exploraci贸n de Power Query en Power BI te permite obtener, limpiar y dar forma a los datos desde m煤ltiples fuentes para prepararlos para el an谩lisis. Con una interfaz intuitiva y potentes capacidades de transformaci贸n, Power Query te ayuda a obtener los datos adecuados y en la forma adecuada para crear informes y visualizaciones impactantes.

[](#铆ndice)

---

## **Tipos de Conexi贸n**

En Power BI, existen varios tipos de conexiones que puedes utilizar para conectar tus datos a tu informe o panel. A continuaci贸n, te proporcionar茅 una explicaci贸n detallada de los tipos de conexi贸n en Power BI con ejemplos:

1. **Conexi贸n Directa a Fuentes de Datos:** Este tipo de conexi贸n permite establecer una conexi贸n directa a una fuente de datos en tiempo real. Power BI env铆a consultas a la fuente de datos cada vez que se actualiza el informe o panel, lo que garantiza que los datos siempre est茅n actualizados.

**Ejemplo:** Puedes establecer una conexi贸n directa a una base de datos SQL Server para acceder a los datos en tiempo real. Cada vez que se visualice el informe, Power BI consultar谩 la base de datos y mostrar谩 los datos m谩s recientes.

2. **Importaci贸n de Datos:** Con esta opci贸n, los datos se importan en el modelo de datos de Power BI y se almacenan en la memoria del equipo. Esto permite un r谩pido acceso a los datos y un rendimiento 贸ptimo al interactuar con el informe o panel. Sin embargo, es necesario programar actualizaciones peri贸dicas para mantener los datos actualizados.

**Ejemplo:** Puedes importar un archivo de Excel que contiene datos de ventas en el modelo de datos de Power BI. Los datos se cargar谩n en la memoria y podr谩s crear visualizaciones r谩pidas y 谩giles.

3. **Conexi贸n Directa a Power BI Service:** Esta opci贸n te permite conectarte directamente a conjuntos de datos y modelos de datos almacenados en Power BI Service (la plataforma en la nube de Power BI). Puedes aprovechar los conjuntos de datos compartidos por otros usuarios y tener acceso en tiempo real a los datos actualizados.

**Ejemplo:** Puedes conectarte directamente a un conjunto de datos compartido por otro usuario en Power BI Service y crear informes basados en esos datos. Cualquier actualizaci贸n realizada en el conjunto de datos se reflejar谩 autom谩ticamente en tu informe.

4. **Conexi贸n Directa a Azure Analysis Services:** Esta opci贸n te permite conectarte directamente a modelos de datos alojados en Azure Analysis Services. Puedes aprovechar la potencia y escalabilidad de Azure para almacenar y analizar grandes vol煤menes de datos.

**Ejemplo:** Puedes conectar Power BI a un modelo de datos en Azure Analysis Services que contiene datos de ventas de m煤ltiples tiendas en diferentes ubicaciones. Esto te permite realizar an谩lisis avanzados y aprovechar la capacidad de procesamiento en la nube.

Es importante tener en cuenta que la elecci贸n del tipo de conexi贸n depende de varios factores, como el tama帽o de los datos, la frecuencia de actualizaci贸n requerida y las capacidades de la fuente de datos. Puedes seleccionar el tipo de conexi贸n m谩s adecuado para tus necesidades espec铆ficas durante la configuraci贸n de la conexi贸n en Power BI.

En resumen, Power BI ofrece diferentes opciones de conexi贸n para conectar tus datos a tu informe o panel. Puedes elegir entre conexiones directas a fuentes de datos en tiempo real, importaci贸n de datos en el modelo de datos de Power BI, conexi贸n directa a Power BI Service o conexi贸n directa a Azure Analysis Services. Cada tipo de conexi贸n tiene sus propias ventajas y consideraciones, y debes seleccionar el m谩s adecuado seg煤n tus requisitos de datos y rendimiento.

[](#铆ndice)

---

## **Extracci贸n de datos**

La extracci贸n de datos en Power BI es el proceso de obtener datos de diversas fuentes y cargarlos en tu modelo de datos para su posterior an谩lisis y visualizaci贸n en informes y paneles. Power BI ofrece varias opciones para extraer datos, lo que te permite conectarte a diferentes tipos de fuentes y obtener la informaci贸n necesaria para tus an谩lisis. A continuaci贸n, te proporcionar茅 una explicaci贸n detallada de las opciones de extracci贸n de datos en Power BI con ejemplos:

1. **Power Query Editor:** Power Query Editor es una herramienta integrada en Power BI que te permite realizar transformaciones en los datos durante el proceso de extracci贸n. Puedes conectarte a diversas fuentes de datos, como bases de datos, archivos planos, servicios en la nube, entre otros, y realizar operaciones de limpieza, filtrado, combinaci贸n y enriquecimiento de datos.

**Ejemplo:** Supongamos que tienes un archivo CSV con datos de ventas. Puedes utilizar Power Query Editor para importar el archivo, eliminar filas o columnas innecesarias, aplicar filtros para seleccionar un per铆odo de tiempo espec铆fico y combinarlo con datos de otras fuentes, como una base de datos SQL Server.

2. **Conexiones Directas:** Power BI te permite establecer conexiones directas a fuentes de datos en tiempo real. Esto significa que los datos se obtienen en tiempo real desde la fuente de datos cada vez que interact煤as con el informe o panel.

**Ejemplo:** Puedes establecer una conexi贸n directa a una base de datos SQL Server y utilizar consultas SQL para obtener los datos necesarios. Al interactuar con el informe, las consultas se ejecutar谩n en la base de datos y mostrar谩n los resultados actualizados.

3. **Conectores de Datos:** Power BI proporciona una amplia gama de conectores de datos que te permiten conectarte a fuentes espec铆ficas sin necesidad de escribir consultas o c贸digo. Estos conectores incluyen servicios en la nube como Azure SQL Database, Salesforce, Google Analytics, entre otros.

**Ejemplo:** Puedes utilizar el conector de Salesforce para extraer datos de tus registros de ventas almacenados en Salesforce. Simplemente debes proporcionar las credenciales de acceso y seleccionar las tablas o vistas relevantes para importar los datos.

4. **Power BI Dataflows:** Los Dataflows de Power BI permiten crear y administrar flujos de datos para reutilizar y compartir en diferentes informes y paneles. Puedes utilizar Dataflows para extraer, transformar y cargar datos desde diferentes fuentes en un formato estructurado y luego utilizarlos en varios informes.

**Ejemplo:** Puedes crear un Dataflow que extraiga datos de una base de datos SQL Server, realice transformaciones y agregue nuevas columnas, y luego lo utilice en varios informes para garantizar la coherencia y la reutilizaci贸n de los datos.

En resumen, Power BI ofrece diversas opciones para la extracci贸n de datos, como Power Query Editor, conexiones directas, conectores de datos y Power BI Dataflows. Estas opciones te permiten conectarte a diferentes fuentes de datos, realizar transformaciones en los datos y cargarlos en tu modelo de datos para su posterior an谩lisis y visualizaci贸n. Puedes elegir la opci贸n de extracci贸n m谩s adecuada seg煤n las caracter铆sticas de tus datos y los requisitos de tu an谩lisis.

[](#铆ndice)

---

## **Transformaciones recurrentes**

En Power BI, las transformaciones recurrentes se refieren a las operaciones que se aplican regularmente a los datos durante el proceso de extracci贸n, transformaci贸n y carga (ETL). Estas transformaciones se realizan de manera consistente en los datos cada vez que se actualizan, lo que ayuda a mantener la calidad y coherencia de los datos. A continuaci贸n, te proporcionar茅 una explicaci贸n detallada de algunas transformaciones recurrentes comunes en Power BI con ejemplos:

1. **Limpieza de datos:** La limpieza de datos implica eliminar o corregir valores incorrectos, duplicados o faltantes en los datos. Algunas transformaciones recurrentes de limpieza de datos incluyen:

- **Eliminaci贸n de filas duplicadas:** Puedes eliminar filas duplicadas para evitar redundancias en tus datos. Por ejemplo, si tienes una tabla de clientes y hay registros duplicados para el mismo cliente, puedes eliminar las filas duplicadas utilizando la funci贸n "Eliminar duplicados" en Power Query Editor.

- **Relleno de valores faltantes:** Puedes rellenar los valores faltantes en tus datos utilizando t茅cnicas como reemplazarlos con un valor predeterminado o utilizar la interpolaci贸n para estimar los valores faltantes en funci贸n de los valores existentes.

2. **Transformaciones de formato:** Las transformaciones de formato se utilizan para cambiar el formato de los datos seg煤n los requisitos de presentaci贸n y an谩lisis. Algunas transformaciones recurrentes de formato incluyen:

- **Cambio de tipo de datos:** Puedes cambiar el tipo de datos de una columna para que se ajuste mejor al contenido de los datos. Por ejemplo, si tienes una columna de fechas representada como texto, puedes convertirla en un tipo de datos de fecha.

- **Conversi贸n de unidades:** Puedes realizar conversiones de unidades para presentar los datos en una unidad m谩s adecuada. Por ejemplo, si tienes datos de ventas en diferentes monedas, puedes convertirlos a una moneda com煤n utilizando tasas de cambio.

3. **Normalizaci贸n de datos:** La normalizaci贸n de datos implica organizar los datos en una estructura consistente para facilitar el an谩lisis y la comparaci贸n. Algunas transformaciones recurrentes de normalizaci贸n de datos incluyen:

- **Descomposici贸n de columnas:** Puedes descomponer una columna que contiene m煤ltiples valores en columnas separadas para una mejor organizaci贸n y an谩lisis. Por ejemplo, si tienes una columna que contiene nombres completos, puedes dividirla en columnas separadas para el nombre y el apellido.

- **Agregaci贸n de datos:** Puedes realizar agregaciones para resumir los datos a un nivel superior. Por ejemplo, si tienes datos de ventas diarias, puedes agregarlos por mes o por a帽o para obtener una vista m谩s general.

Estos son solo algunos ejemplos de transformaciones recurrentes que se pueden aplicar en Power BI. El objetivo principal de estas transformaciones es preparar los datos para el an谩lisis y garantizar la calidad y coherencia de los mismos. Puedes aplicar estas transformaciones utilizando Power Query Editor, que es una herramienta poderosa en Power BI que te permite realizar una amplia variedad de transformaciones en tus datos antes de cargarlos en tu modelo de datos.

[](#铆ndice)

---

## **Creaci贸n de columnas condicionales**

En Power BI, puedes crear columnas condicionales utilizando expresiones y funciones para evaluar una condici贸n y generar un valor nuevo en funci贸n de esa condici贸n. Estas columnas condicionales te permiten realizar c谩lculos o clasificaciones basados en ciertas condiciones espec铆ficas. A continuaci贸n, te proporcionar茅 una explicaci贸n detallada sobre c贸mo crear columnas condicionales en Power BI con ejemplos:

1. Abre Power BI Desktop y carga tus datos en el modelo de datos.

2. Haz clic en la pesta帽a "Modelado" en la cinta de opciones.

3. En el grupo "Columnas", haz clic en "Nueva columna" para crear una nueva columna condicional.

4. En la barra de f贸rmulas, escribe una expresi贸n que eval煤e la condici贸n. Por ejemplo, supongamos que tienes una tabla de ventas y quieres crear una columna llamada "Estado de venta" que muestre si una venta es "Alta" o "Baja" en funci贸n de su importe. Puedes usar la siguiente expresi贸n:

`Estado de venta = IF(Sales[Importe] > 1000, "Alta", "Baja")`

En este ejemplo, la expresi贸n eval煤a si el importe de la venta es mayor que 1000. Si es cierto, se asigna el valor "Alta" a la columna "Estado de venta"; de lo contrario, se asigna el valor "Baja".

5. Presiona Enter para completar la creaci贸n de la columna condicional. La nueva columna se agregar谩 a la tabla de datos.

Ahora, cada fila de la columna "Estado de venta" mostrar谩 el resultado de la evaluaci贸n de la condici贸n para esa fila en particular. Por ejemplo, si una venta tiene un importe de 1200, la columna "Estado de venta" mostrar谩 "Alta"; si tiene un importe de 800, mostrar谩 "Baja".

Puedes utilizar diversas funciones y operadores en tus expresiones condicionales para lograr diferentes resultados. Algunas funciones 煤tiles para crear columnas condicionales en Power BI incluyen:

- **IF:** Se utiliza para evaluar una condici贸n y devolver un resultado si la condici贸n es verdadera y otro resultado si es falsa.
- **SWITCH:** Permite realizar m煤ltiples comprobaciones y devuelve un resultado en funci贸n de la coincidencia de una o varias condiciones.
- **IIF:** Similar a la funci贸n IF, pero permite realizar una evaluaci贸n m谩s compacta con una sintaxis m谩s corta.

A continuaci贸n, se muestra un ejemplo adicional de c贸mo crear una columna condicional utilizando la funci贸n SWITCH:

`Tipo de cliente = SWITCH(Clientes[Categoria], "A", "Cliente Premium", "B", "Cliente Est谩ndar", "C", "Cliente B谩sico", "Otro")`

En este caso, la expresi贸n eval煤a el valor de la columna "Categor铆a" en la tabla de clientes y asigna un tipo de cliente correspondiente utilizando la funci贸n SWITCH.

Recuerda que las columnas condicionales son calculadas y se actualizan autom谩ticamente cuando los datos subyacentes cambian. Puedes utilizar estas columnas en visualizaciones y an谩lisis dentro de Power BI para obtener informaci贸n y tomar decisiones basadas en las condiciones definidas.

[](#铆ndice)

---

## **Anexar datos**

En Power BI, puedes anexar datos de diferentes fuentes o tablas para combinarlos y trabajar con ellos como un 煤nico conjunto de datos. Esto te permite realizar an谩lisis m谩s completos y obtener una visi贸n m谩s integral de tus datos. A continuaci贸n, te proporcionar茅 una explicaci贸n detallada sobre c贸mo anexar datos en Power BI con ejemplos:

1. Abre Power BI Desktop y carga tus fuentes de datos en el modelo de datos. Pueden ser archivos de Excel, bases de datos, servicios en l铆nea u otras fuentes compatibles.

2. En la pesta帽a "Inicio" de la cinta de opciones, haz clic en "Administrar relaciones" para abrir el Editor de consultas y gestionar tus datos.

3. En el Editor de consultas, selecciona una de las tablas que deseas anexar a otra tabla o fuente de datos.

4. Haz clic con el bot贸n derecho del rat贸n sobre la tabla seleccionada y elige la opci贸n "Anexar consultas" en el men煤 contextual.

5. Se abrir谩 el cuadro de di谩logo "Anexar consultas". Aqu铆, elige la segunda tabla o fuente de datos que deseas anexar y haz clic en "Aceptar".

6. Power BI combinar谩 las dos tablas seg煤n una columna coincidente o una relaci贸n definida previamente. Si no hay una relaci贸n definida, puedes seleccionar las columnas en las que se basar谩 el anexo.

7. Ver谩s que se crea una nueva consulta en el Editor de consultas que representa la combinaci贸n de las dos tablas anexadas.

8. En el Editor de consultas, puedes realizar transformaciones adicionales, como filtrar columnas, renombrar columnas o aplicar operaciones de limpieza de datos.

9. Haz clic en "Cerrar y aplicar" en la pesta帽a "Inicio" para cargar los datos anexados en el modelo de datos de Power BI.

A continuaci贸n, te doy un ejemplo pr谩ctico: supongamos que tienes una tabla de ventas en un archivo de Excel y una tabla de clientes en una base de datos. Deseas anexar estos datos para tener una vista completa de las ventas junto con la informaci贸n de los clientes.

1. Carga el archivo de Excel y la base de datos en Power BI Desktop como fuentes de datos separadas.

2. Abre el Editor de consultas y selecciona la tabla de ventas.

3. Haz clic con el bot贸n derecho del rat贸n sobre la tabla de ventas y selecciona "Anexar consultas".

4. Selecciona la tabla de clientes como la segunda tabla para anexar.

5. Elige la columna "ID de cliente" en ambas tablas como la columna coincidente para el anexo.

6. Verifica que las transformaciones de datos sean las adecuadas, como eliminar columnas innecesarias o renombrar columnas para mayor claridad.

7. Cierra el Editor de consultas y aplica los cambios.

Ahora tendr谩s una nueva tabla que combina los datos de ventas y clientes en un solo conjunto de datos. Puedes utilizar esta tabla para realizar an谩lisis y visualizaciones en Power BI.

El anexo de datos en Power BI te permite consolidar informaci贸n de diferentes fuentes y obtener una vista completa de tus datos para un an谩lisis m谩s completo y preciso.

[](#铆ndice)

---

## **Fusionar Archivos o Tablas**

En Power BI, puedes fusionar archivos o tablas para combinar sus datos y trabajar con ellos como un solo conjunto de datos. Esta funci贸n es 煤til cuando tienes varios archivos o tablas con informaci贸n similar que deseas unificar en un solo conjunto de datos para realizar an谩lisis y visualizaciones m谩s completas. A continuaci贸n, te proporcionar茅 una explicaci贸n detallada sobre c贸mo fusionar archivos o tablas en Power BI con ejemplos:

1. Abre Power BI Desktop y carga los archivos o tablas que deseas fusionar en el modelo de datos. Pueden ser archivos de Excel, CSV, bases de datos u otras fuentes compatibles.

2. En la pesta帽a "Inicio" de la cinta de opciones, haz clic en "Administrar relaciones" para abrir el Editor de consultas y gestionar tus datos.

3. En el Editor de consultas, selecciona una de las tablas que deseas fusionar con otra tabla o archivo.

4. Haz clic con el bot贸n derecho del rat贸n sobre la tabla seleccionada y elige la opci贸n "Fusionar consultas" en el men煤 contextual.

5. Se abrir谩 el cuadro de di谩logo "Fusionar consultas". Aqu铆, elige la segunda tabla o archivo que deseas fusionar y selecciona las columnas en las que se basar谩 la fusi贸n. Estas columnas deben contener valores coincidentes.

6. Power BI fusionar谩 las dos tablas seg煤n las columnas coincidentes seleccionadas y crear谩 una nueva tabla combinada.

7. En el Editor de consultas, puedes realizar transformaciones adicionales en la tabla fusionada, como filtrar columnas, renombrar columnas o aplicar operaciones de limpieza de datos.

8. Haz clic en "Cerrar y aplicar" en la pesta帽a "Inicio" para cargar los datos fusionados en el modelo de datos de Power BI.

A continuaci贸n, te doy un ejemplo pr谩ctico: supongamos que tienes dos archivos de Excel, uno con informaci贸n de ventas y otro con informaci贸n de clientes. Deseas fusionar estos archivos para tener un conjunto de datos completo que contenga informaci贸n de ventas y la informaci贸n correspondiente de los clientes.

1. Carga los dos archivos de Excel en Power BI Desktop como fuentes de datos separadas.

2. Abre el Editor de consultas y selecciona la tabla de ventas.

3. Haz clic con el bot贸n derecho del rat贸n sobre la tabla de ventas y selecciona "Fusionar consultas".

4. Selecciona la tabla de clientes como la segunda tabla para fusionar.

5. Elige la columna "ID de cliente" en ambas tablas como la columna coincidente para la fusi贸n.

6. Verifica que las transformaciones de datos sean las adecuadas, como eliminar columnas innecesarias o renombrar columnas para mayor claridad.

7. Cierra el Editor de consultas y aplica los cambios.

Ahora tendr谩s una nueva tabla que combina los datos de ventas con la informaci贸n correspondiente de los clientes en un solo conjunto de datos. Puedes utilizar esta tabla fusionada para realizar an谩lisis y visualizaciones en Power BI.

La fusi贸n de archivos o tablas en Power BI te permite consolidar informaci贸n de diferentes fuentes y tener un conjunto de datos completo para an谩lisis y visualizaciones m谩s eficaces. Esto facilita la comprensi贸n y la toma de decisiones basadas en datos.

[](#铆ndice)

---

## **Agrupar datos**

En Power BI, puedes agrupar datos para resumirlos y realizar an谩lisis m谩s detallados. La funci贸n de agrupaci贸n te permite combinar filas de datos en categor铆as o segmentos basados en un criterio espec铆fico. A continuaci贸n, te proporcionar茅 una explicaci贸n detallada sobre c贸mo agrupar datos en Power BI con ejemplos:

1. Abre Power BI Desktop y carga los datos en el modelo de datos. Pueden ser archivos de Excel, CSV, bases de datos u otras fuentes compatibles.

2. En la pesta帽a "Inicio" de la cinta de opciones, haz clic en "Administrar relaciones" para abrir el Editor de consultas y gestionar tus datos.

3. En el Editor de consultas, selecciona la tabla o consulta que deseas agrupar.

4. Haz clic con el bot贸n derecho del rat贸n sobre la columna en la que deseas basar la agrupaci贸n y selecciona la opci贸n "Agrupar por" en el men煤 contextual.

5. Se abrir谩 el cuadro de di谩logo "Agrupar por". Aqu铆, define los criterios de agrupaci贸n especificando una columna de agrupaci贸n y los valores o rangos que deseas agrupar.

6. Puedes agregar varias columnas de agrupaci贸n para crear agrupaciones jer谩rquicas o m谩s complejas. Esto te permite obtener un nivel de detalle adicional en tus resultados.

7. Personaliza la configuraci贸n de agrupaci贸n, como el nombre de la columna de agrupaci贸n resultante y el tipo de agregaci贸n que deseas aplicar a otras columnas en el grupo (por ejemplo, suma, promedio, m谩ximo, m铆nimo, etc.).

8. Aplica los cambios y cierra el Editor de consultas.

A continuaci贸n, te doy un ejemplo pr谩ctico: supongamos que tienes una tabla de datos de ventas con informaci贸n sobre productos, cantidades vendidas y fechas de venta. Deseas agrupar las ventas por mes para obtener un resumen mensual de las ventas totales.

1. Carga la tabla de datos de ventas en Power BI Desktop.

2. Abre el Editor de consultas y selecciona la tabla de ventas.

3. Haz clic con el bot贸n derecho del rat贸n sobre la columna de fecha de venta y selecciona la opci贸n "Agrupar por".

4. En el cuadro de di谩logo "Agrupar por", selecciona "A帽o" y "Mes" como columnas de agrupaci贸n.

5. Define la configuraci贸n de agrupaci贸n, como el nombre de la columna resultante y la columna de suma de ventas.

6. Aplica los cambios y cierra el Editor de consultas.

Ahora tendr谩s una nueva tabla que muestra las ventas agrupadas por mes. Puedes utilizar esta tabla agrupada para realizar an谩lisis y visualizaciones, como un gr谩fico de barras que muestra las ventas mensuales.

La funci贸n de agrupaci贸n en Power BI te permite resumir y analizar datos de manera m谩s significativa. Puedes agrupar datos por categor铆as como fechas, productos, regiones u otras variables relevantes en tu conjunto de datos. Esto te ayuda a identificar patrones, tendencias y realizar an谩lisis m谩s profundos para respaldar la toma de decisiones informada.

[](#铆ndice)

---

## **Transponer datos**

La funci贸n de transposici贸n en Power BI te permite reorganizar los datos de forma que las filas se conviertan en columnas y las columnas se conviertan en filas. Esta operaci贸n es 煤til cuando deseas cambiar la estructura de tus datos para facilitar el an谩lisis o la visualizaci贸n. A continuaci贸n, te proporcionar茅 una explicaci贸n detallada sobre c贸mo transponer datos en Power BI con ejemplos:

1. Abre Power BI Desktop y carga los datos en el modelo de datos. Pueden ser archivos de Excel, CSV, bases de datos u otras fuentes compatibles.

2. En la pesta帽a "Inicio" de la cinta de opciones, haz clic en "Administrar relaciones" para abrir el Editor de consultas y gestionar tus datos.

3. En el Editor de consultas, selecciona la tabla o consulta que deseas transponer.

4. Haz clic con el bot贸n derecho del rat贸n sobre la tabla y selecciona la opci贸n "Transponer" en el men煤 contextual.

5. Se reorganizar谩n las filas y columnas de la tabla. Las filas originales se convertir谩n en columnas y las columnas originales se convertir谩n en filas.

6. Puedes ajustar la configuraci贸n de transposici贸n seg煤n tus necesidades. Por ejemplo, puedes especificar una columna que se utilizar谩 como encabezados de las nuevas columnas o asignar nombres personalizados a las nuevas columnas.

7. Aplica los cambios y cierra el Editor de consultas.

A continuaci贸n, te doy un ejemplo pr谩ctico: supongamos que tienes una tabla de datos que muestra los ingresos mensuales de diferentes productos. Cada producto se encuentra en una columna y cada fila representa un mes. Deseas transponer estos datos para tener una tabla donde cada fila represente un producto y cada columna sea un mes.

1. Carga la tabla de datos en Power BI Desktop.

2. Abre el Editor de consultas y selecciona la tabla de datos.

3. Haz clic con el bot贸n derecho del rat贸n sobre la tabla y selecciona la opci贸n "Transponer".

4. Se reorganizar谩n las filas y columnas de la tabla. Ahora, cada fila representa un producto y cada columna es un mes.

5. Puedes ajustar la configuraci贸n de transposici贸n, como especificar una columna de encabezado para los meses o asignar nombres personalizados a las nuevas columnas.

6. Aplica los cambios y cierra el Editor de consultas.

Ahora tendr谩s una nueva tabla donde cada fila representa un producto y cada columna es un mes. Esto facilita el an谩lisis y la visualizaci贸n de los ingresos por producto a lo largo del tiempo.

La funci贸n de transposici贸n en Power BI te permite cambiar la estructura de tus datos para adaptarse a tus necesidades de an谩lisis y visualizaci贸n. Es especialmente 煤til cuando tienes datos organizados en un formato que dificulta el an谩lisis directo y deseas reorganizarlos para obtener una vista m谩s conveniente.

[](#铆ndice)

---

## **Buenas pr谩cticas en Power Query**

Al trabajar con Power Query en Power BI, existen algunas buenas pr谩cticas que puedes seguir para garantizar una carga de datos eficiente y una preparaci贸n adecuada de los datos. A continuaci贸n, te proporcionar茅 algunas de estas buenas pr谩cticas con ejemplos:

1. **Filtrar y reducir datos innecesarios:** Es recomendable filtrar los datos en Power Query para reducir el tama帽o de la carga y mejorar el rendimiento. Puedes eliminar columnas que no sean relevantes para tu an谩lisis o filtrar filas basadas en criterios espec铆ficos. Por ejemplo, si tienes una tabla con datos de ventas de productos y solo est谩s interesado en las ventas de un pa铆s en particular, puedes filtrar las filas correspondientes a ese pa铆s.

**Ejemplo:**

```
let
    fuente = Excel.Workbook(File.Contents("C:\Datos.xlsx"), null, true),
    tabla = fuente{[Item="Ventas",Kind="Sheet"]}[Data],
    filtrado = Table.SelectRows(tabla, each [Pais] = "Espa帽a"),
    columnasEliminadas = Table.RemoveColumns(filtrado, {"Fecha"})
in
    columnasEliminadas

```

2. **Renombrar columnas de manera descriptiva:** Es recomendable utilizar nombres de columna descriptivos y significativos en lugar de los nombres predeterminados o abreviaturas. Esto facilitar谩 la comprensi贸n de los datos y el mantenimiento del modelo. Por ejemplo, en lugar de tener columnas con nombres como "Col1", "Col2", etc., puedes renombrarlas a algo m谩s descriptivo como "Producto", "Cantidad", etc.

**Ejemplo:**

```
let
    fuente = Excel.Workbook(File.Contents("C:\Datos.xlsx"), null, true),
    tabla = fuente{[Item="Ventas",Kind="Sheet"]}[Data],
    columnasRenombradas = Table.RenameColumns(tabla,{{"Col1", "Producto"}, {"Col2", "Cantidad"}})
in
    columnasRenombradas
```

3. **Aplicar pasos en el orden correcto:** Aseg煤rate de aplicar los pasos de transformaci贸n en el orden adecuado para obtener los resultados deseados. Por ejemplo, si deseas filtrar y luego ordenar los datos, aseg煤rate de aplicar el paso de filtrado antes del paso de ordenaci贸n. El orden incorrecto de los pasos puede afectar los resultados o provocar errores.

**Ejemplo:**

```
let
    fuente = Excel.Workbook(File.Contents("C:\Datos.xlsx"), null, true),
    tabla = fuente{[Item="Ventas",Kind="Sheet"]}[Data],
    filtrado = Table.SelectRows(tabla, each [Pais] = "Espa帽a"),
    ordenado = Table.Sort(filtrado,{{"Fecha", Order.Descending}})
in
    ordenado
```

4. **Usar consultas de referencia:** En lugar de repetir los mismos pasos de transformaci贸n en varias consultas, puedes crear consultas de referencia. Esto implica crear una consulta principal con los pasos de transformaci贸n y luego referenciar esa consulta en otras consultas que necesiten los mismos datos transformados. Esto mejora la eficiencia y facilita el mantenimiento, ya que solo necesitas realizar los cambios en la consulta principal y se reflejar谩n autom谩ticamente en las consultas de referencia.

**Ejemplo:**

Supongamos que tienes una consulta llamada "DatosBrutos" que realiza ciertos pasos de transformaci贸n. Luego, puedes crear una consulta de referencia llamada "DatosTransformados" que hace referencia a "DatosBrutos" y aplica pasos adicionales si es necesario.

5. **Documentar tus pasos de transformaci贸n:** Es recomendable documentar los pasos de transformaci贸n que aplicas en Power Query. Puedes agregar comentarios en el editor de consultas para explicar el prop贸sito de cada paso y cualquier decisi贸n importante que hayas tomado. Esto facilitar谩 la comprensi贸n y el mantenimiento del flujo de datos.
   Estas son solo algunas de las buenas pr谩cticas que puedes seguir al trabajar con Power Query en Power BI. Siguiendo estos consejos, podr谩s preparar tus datos de manera m谩s eficiente, mejorar el rendimiento y mantener un flujo de trabajo ordenado y f谩cil de mantener.

[](#铆ndice)

---

| **Inicio**               | **atr谩s 1**                          | **Siguiente 3**                |
| ------------------------ | ------------------------------------ | ------------------------------ |
| [](../../../README.md) | [](./1.INTRODUCCION_A_POWER_BI.md) | [](./3.MODELADO_DE_DATOS.md) |
