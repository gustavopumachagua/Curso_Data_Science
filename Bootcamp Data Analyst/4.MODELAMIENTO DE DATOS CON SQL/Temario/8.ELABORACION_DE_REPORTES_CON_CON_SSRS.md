| **Inicio**               | **atr√°s 7**                                         |
| ------------------------ | --------------------------------------------------- |
| [üè†](../../../README.md) | [‚è™](./7.MODELAMIENTO_MULTIDIMENSIONAL_CON_SSAS.md) |

---

## **√çndice**

| Temario                                                                                         |
| ----------------------------------------------------------------------------------------------- |
| [Configuraci√≥n para la instalaci√≥n de SSRS](#configuraci√≥n-para-la-instalaci√≥n-de-ssrs)         |
| [Creaci√≥n de informes agrupados y subreportes](#creaci√≥n-de-informes-agrupados-y-subreportes)   |
| [Definici√≥n de par√°metros simples y en cascada](#definici√≥n-de-par√°metros-simples-y-en-cascada) |
| [Tipos de reportes matriz y gr√°ficos](#tipos-de-reportes-matriz-y-gr√°ficos)                     |
| [Ordenamiento condicional](#ordenamiento-condicional)                                           |
| [Aplicaci√≥n de pie de p√°ginas y cabeceras](#aplicaci√≥n-de-pie-de-p√°ginas-y-cabeceras)           |

---

# **8. ELABORACI√ìN DE REPORTES CON CON SSRS**

---

## **Configuraci√≥n para la instalaci√≥n de SSRS**

La instalaci√≥n de SQL Server Reporting Services (SSRS) implica realizar una serie de configuraciones para garantizar un funcionamiento adecuado. A continuaci√≥n, te proporcionar√© una explicaci√≥n detallada de las configuraciones necesarias, junto con ejemplos.

1. **Verificar los requisitos del sistema:**

Antes de comenzar la instalaci√≥n de SSRS, es importante verificar los requisitos del sistema para asegurarse de que el servidor cumpla con los requerimientos m√≠nimos. Estos requisitos incluyen la versi√≥n y edici√≥n de SQL Server, el sistema operativo compatible, los servicios y caracter√≠sticas adicionales requeridos, y los permisos de usuario necesarios.

2. **Configurar la instancia de SQL Server:**

Si a√∫n no tienes una instancia de SQL Server instalada, debes realizar la instalaci√≥n de SQL Server antes de proceder con la instalaci√≥n de SSRS. Durante la instalaci√≥n de SQL Server, aseg√∫rate de seleccionar los componentes de Reporting Services para habilitar su funcionalidad.

3. **Configurar la instancia de SSRS:**

Una vez que hayas instalado SQL Server y habilitado Reporting Services, deber√°s configurar la instancia de SSRS. Esto implica realizar los siguientes pasos:

- **Abrir el Administrador de Configuraci√≥n de Reporting Services:** Puedes encontrarlo en el men√∫ de inicio o buscando "Reporting Services Configuration Manager".

- **Conectar a la instancia de SQL Server:** En el Administrador de Configuraci√≥n, selecciona la instancia de SQL Server en la lista desplegable "Conectar a una instancia de informes".

- **Configurar el servicio de informes:** En la pesta√±a "Servicio de informes", especifica el nombre de la instancia de informes y el puerto que se utilizar√° para acceder al servicio. Tambi√©n puedes configurar las opciones de autenticaci√≥n y seguridad seg√∫n tus necesidades.

- **Configurar la base de datos de informes:** En la pesta√±a "Base de datos", selecciona si deseas crear una base de datos de informes o si ya tienes una existente que deseas utilizar. Si est√°s creando una nueva base de datos, proporciona un nombre y configura las opciones adicionales seg√∫n tus preferencias.

- **Configurar el acceso web:** En la pesta√±a "Acceso web", especifica las opciones de autenticaci√≥n y configuraci√≥n de HTTPS para el acceso web a los informes.

4. **Verificar la configuraci√≥n:**

Una vez que hayas realizado la configuraci√≥n en el Administrador de Configuraci√≥n de Reporting Services, verifica que todo est√© configurado correctamente. Puedes hacerlo probando el acceso al Portal web de informes a trav√©s de un navegador web. Intenta acceder al portal utilizando la URL especificada durante la configuraci√≥n (por ejemplo, http://localhost/Reports) y verifica que puedas ver y ejecutar informes.

Estos son los pasos b√°sicos para configurar la instalaci√≥n de SQL Server Reporting Services (SSRS). Recuerda que la configuraci√≥n espec√≠fica puede variar dependiendo de tu entorno y requisitos. Aseg√∫rate de seguir las gu√≠as y documentaci√≥n oficial de Microsoft para obtener instrucciones detalladas y actualizadas.

[üîº](#√≠ndice)

---

## **Creaci√≥n de informes agrupados y subreportes**

La creaci√≥n de informes agrupados y subinformes en SQL Server Reporting Services (SSRS) permite organizar y presentar datos de manera jer√°rquica y estructurada. A continuaci√≥n, te proporcionar√© una explicaci√≥n detallada de c√≥mo crear informes agrupados y subinformes, junto con ejemplos.

1. **Informes agrupados:**

Los informes agrupados se utilizan para resumir y mostrar datos agrupados en funci√≥n de una o m√°s columnas. Estos informes son √∫tiles cuando se necesita presentar datos de forma jer√°rquica, como totales por categor√≠as o regiones. A continuaci√≥n, se muestra un ejemplo de c√≥mo crear un informe agrupado:

- Abre SQL Server Data Tools (SSDT) o el dise√±ador de informes de SSRS.

- Crea un nuevo informe y agrega un origen de datos adecuado, como una conexi√≥n a una base de datos.

- Arrastra y suelta los campos relevantes desde el origen de datos al √°rea de dise√±o del informe.

- Selecciona los campos que deseas utilizar para agrupar los datos y arr√°stralos a la secci√≥n "Filas" o "Columnas" en el √°rea de dise√±o.

- Agrega los campos de datos que deseas mostrar dentro de cada grupo en la secci√≥n correspondiente del √°rea de dise√±o.

- Configura cualquier c√°lculo o agregaci√≥n necesario, como sumas o promedios, utilizando expresiones o funciones de SSRS.

- Ajusta el dise√±o del informe seg√∫n tus preferencias, incluyendo encabezados, pies de p√°gina y formatos visuales.

- Previsualiza y verifica el informe para asegurarte de que los datos se muestren correctamente agrupados.

2. **Subinformes:**

Los subinformes se utilizan para incluir informes secundarios dentro de un informe principal. Los subinformes son √∫tiles cuando se necesita presentar informaci√≥n detallada o adicional relacionada con los datos principales. A continuaci√≥n, se muestra un ejemplo de c√≥mo crear un subinforme:

- Abre SQL Server Data Tools (SSDT) o el dise√±ador de informes de SSRS.

- Crea un nuevo informe para el informe principal y otro informe para el subinforme.

- Configura los datos y dise√±o del informe principal como se describi√≥ anteriormente.

- En el informe principal, arrastra y suelta un objeto "Subinforme" desde la caja de herramientas al √°rea de dise√±o.

- Configura la propiedad "Ruta de acceso del informe" del subinforme para especificar la ubicaci√≥n del informe secundario.

- Configura los par√°metros del subinforme si es necesario, para filtrar los datos o pasar valores desde el informe principal al subinforme.

- Personaliza el dise√±o y formato del subinforme seg√∫n tus necesidades.

Previsualiza y verifica el informe principal para asegurarte de que el subinforme se muestra correctamente y est√° vinculado correctamente a los datos principales.

Recuerda que los informes agrupados y subinformes en SSRS ofrecen una amplia gama de opciones de dise√±o y funcionalidad. Puedes personalizar a√∫n m√°s los informes utilizando expresiones, variables y otras caracter√≠sticas avanzadas de SSRS.

[üîº](#√≠ndice)

---

## **Definici√≥n de par√°metros simples y en cascada**

En SQL Server Reporting Services (SSRS), los par√°metros son elementos importantes que permiten a los usuarios filtrar y personalizar los datos en un informe. Hay dos tipos principales de par√°metros: par√°metros simples y par√°metros en cascada. A continuaci√≥n, te proporcionar√© una explicaci√≥n detallada de cada uno de ellos, junto con ejemplos.

1. **Par√°metros simples:**

Los par√°metros simples son aquellos que permiten a los usuarios seleccionar un √∫nico valor de una lista predefinida. Estos par√°metros son √∫tiles cuando se desea filtrar los datos de acuerdo con una opci√≥n espec√≠fica. A continuaci√≥n, se muestra un ejemplo de c√≥mo crear un par√°metro simple:

- Abre SQL Server Data Tools (SSDT) o el dise√±ador de informes de SSRS.

- Crea un nuevo informe y agrega un origen de datos adecuado, como una conexi√≥n a una base de datos.

- En el √°rea de dise√±o del informe, ve a la pesta√±a "Par√°metros" en la parte inferior del panel de informes.

- Haz clic en "Agregar par√°metro" y proporciona un nombre descriptivo para el par√°metro.

- Define el tipo de dato del par√°metro, como texto, fecha o n√∫mero, y establece cualquier valor predeterminado o restricciones necesarias.

- Define los valores posibles para el par√°metro. Puedes obtenerlos de una consulta SQL, de una lista est√°tica o de una consulta de datos existente.

- Utiliza el par√°metro en las consultas y expresiones del informe para filtrar los datos seg√∫n la selecci√≥n del usuario.

- Previsualiza y verifica el informe para asegurarte de que el par√°metro funcione correctamente y filtre los datos de acuerdo con la selecci√≥n del usuario.

2. **Par√°metros en cascada:**

Los par√°metros en cascada son aquellos que dependen de la selecci√≥n de otro par√°metro. Estos par√°metros est√°n vinculados y su lista de valores se actualiza din√°micamente en funci√≥n de la selecci√≥n realizada en el par√°metro anterior. Son √∫tiles cuando se necesita filtrar datos en m√∫ltiples niveles o jerarqu√≠as. A continuaci√≥n, se muestra un ejemplo de c√≥mo crear par√°metros en cascada:

- Sigue los mismos pasos anteriores para crear los par√°metros simples iniciales.

- Crea un segundo par√°metro que se basar√° en la selecci√≥n del primer par√°metro.

- Define los valores posibles para el segundo par√°metro utilizando una consulta SQL que tome como entrada la selecci√≥n del primer par√°metro.

- Utiliza el segundo par√°metro en las consultas y expresiones del informe para filtrar los datos seg√∫n la selecci√≥n del usuario en ambos par√°metros.

- Previsualiza y verifica el informe para asegurarte de que los par√°metros en cascada funcionen correctamente y los datos se filtren seg√∫n las selecciones del usuario.

Los par√°metros simples y en cascada ofrecen flexibilidad y capacidad de personalizaci√≥n en los informes de SSRS. Puedes utilizar expresiones y funciones adicionales para ajustar a√∫n m√°s el comportamiento de los par√°metros y adaptarlos a tus necesidades espec√≠ficas.

[üîº](#√≠ndice)

---

## **Tipos de reportes matriz y gr√°ficos**

En SQL Server Reporting Services (SSRS), existen diferentes tipos de reportes que se pueden utilizar para presentar datos de manera efectiva. Dos de los tipos m√°s comunes son los reportes matriz y los reportes gr√°ficos. A continuaci√≥n, te proporcionar√© una explicaci√≥n detallada de cada uno de ellos, junto con ejemplos.

1. **Reportes matriz:**

Los reportes matriz son √∫tiles cuando se desea presentar datos en una estructura de tabla bidimensional, donde las filas y columnas representan diferentes categor√≠as y los valores se muestran en las intersecciones. Este tipo de reporte es especialmente √∫til cuando se desea realizar comparaciones entre diferentes elementos. A continuaci√≥n, se muestra un ejemplo de c√≥mo crear un reporte matriz:

- Abre SQL Server Data Tools (SSDT) o el dise√±ador de informes de SSRS.

- Crea un nuevo informe y agrega un origen de datos adecuado, como una conexi√≥n a una base de datos.

- Arrastra y suelta un objeto "Tabla" desde la caja de herramientas al √°rea de dise√±o del informe.

- Configura las columnas de la tabla para representar las diferentes categor√≠as o elementos que deseas mostrar.

- Configura las filas de la tabla para representar las diferentes subcategor√≠as o elementos adicionales.

- Configura las celdas de la tabla para mostrar los valores correspondientes a la intersecci√≥n de las filas y columnas.

- Aplica formatos y estilos visuales seg√∫n tus preferencias para mejorar la legibilidad del reporte.

- Previsualiza y verifica el informe para asegurarte de que los datos se muestren correctamente en la estructura de matriz.

2. **Reportes gr√°ficos:**

Los reportes gr√°ficos son √∫tiles para visualizar datos de manera m√°s intuitiva y comprensible utilizando gr√°ficos y visualizaciones visuales. Permiten identificar patrones, tendencias y comparaciones de manera m√°s r√°pida y efectiva. A continuaci√≥n, se muestra un ejemplo de c√≥mo crear un reporte gr√°fico:

- Abre SQL Server Data Tools (SSDT) o el dise√±ador de informes de SSRS.

- Crea un nuevo informe y agrega un origen de datos adecuado, como una conexi√≥n a una base de datos.

- Arrastra y suelta un objeto "Gr√°fico" desde la caja de herramientas al √°rea de dise√±o del informe.

- Configura los datos del gr√°fico seleccionando la fuente de datos y los campos relevantes.

- Selecciona el tipo de gr√°fico que mejor se adapte a tus necesidades, como gr√°fico de barras, gr√°fico circular, gr√°fico de l√≠neas, etc.

- Configura las series y categor√≠as del gr√°fico utilizando los campos de datos adecuados.

- Personaliza los ejes, leyendas, t√≠tulos y otros aspectos visuales del gr√°fico seg√∫n tus preferencias.

- Previsualiza y verifica el informe para asegurarte de que el gr√°fico muestre los datos de manera clara y efectiva.

Los reportes matriz y los reportes gr√°ficos son solo algunos ejemplos de los tipos de informes disponibles en SSRS. Dependiendo de tus necesidades y los datos que deseas presentar, puedes explorar otros tipos de informes, como informes de tabla, informes de lista, informes de matriz combinada, etc.

[üîº](#√≠ndice)

---

## **Ordenamiento condicional**

El ordenamiento condicional, tambi√©n conocido como ordenamiento personalizado o ordenamiento basado en condiciones, se refiere a la capacidad de ordenar los datos en una consulta SQL en funci√≥n de una condici√≥n espec√≠fica en lugar de simplemente ordenarlos alfab√©ticamente o num√©ricamente. Esto permite establecer reglas personalizadas para determinar el orden de los resultados de una consulta. A continuaci√≥n, te proporcionar√© una explicaci√≥n detallada con ejemplos.

Supongamos que tienes una tabla llamada "`Productos`" con las siguientes columnas: "`Nombre`" (cadena de texto) y "`Stock`" (entero). Quieres ordenar los productos de acuerdo con las siguientes reglas:

- Los productos con stock disponible deben aparecer primero en el resultado.
- Los productos con stock agotado deben aparecer despu√©s de los productos disponibles, pero antes de los productos restantes.
- Para lograr esto, puedes utilizar una cl√°usula "ORDER BY" en tu consulta SQL junto con una expresi√≥n condicional. Aqu√≠ tienes un ejemplo de c√≥mo lograrlo:

```
SELECT Nombre, Stock
FROM Productos
ORDER BY
    CASE
        WHEN Stock > 0 THEN 1 -- Productos con stock disponible
        WHEN Stock = 0 THEN 2 -- Productos agotados
        ELSE 3 -- Otros productos
    END;
```

En este ejemplo, utilizamos la expresi√≥n condicional `CASE` dentro de la cl√°usula "`ORDER BY`". La expresi√≥n `CASE` eval√∫a la columna "`Stock`" y asigna un valor num√©rico a cada fila seg√∫n la condici√≥n correspondiente. Luego, ordenamos los resultados en funci√≥n de esos valores num√©ricos, lo que asegura que los productos disponibles aparezcan primero, seguidos de los productos agotados y finalmente los dem√°s productos.

El resultado de la consulta mostrar√° los productos ordenados de acuerdo con las reglas establecidas. Por ejemplo:

```
Nombre      | Stock
--------------------
Producto A  | 5
Producto B  | 0
Producto C  | 2
Producto D  | 0
Producto E  | 10
```

En este resultado, los productos disponibles (stock > 0) se muestran primero, seguidos de los productos agotados (stock = 0) y, finalmente, los productos con otros valores de stock.

El ordenamiento condicional te permite personalizar el orden de los resultados de una consulta seg√∫n tus necesidades y reglas espec√≠ficas. Puedes utilizar expresiones condicionales m√°s complejas con m√∫ltiples condiciones para definir reglas de ordenamiento m√°s elaboradas.

[üîº](#√≠ndice)

---

## **Aplicaci√≥n de pie de p√°ginas y cabeceras**

La aplicaci√≥n de pie de p√°ginas y cabeceras en informes o documentos es una pr√°ctica com√∫n para agregar informaci√≥n adicional, como n√∫meros de p√°gina, fechas, t√≠tulos o logotipos, que se muestra de manera consistente en todas las p√°ginas. A continuaci√≥n, te proporcionar√© una explicaci√≥n detallada sobre c√≥mo aplicar pie de p√°ginas y cabeceras en informes, junto con ejemplos utilizando SQL Server Reporting Services (SSRS).

Para comenzar, asumamos que est√°s creando un informe utilizando el dise√±ador de informes de SSRS. Aqu√≠ tienes los pasos para aplicar pie de p√°gina y cabecera:

1. **Abrir el informe en el dise√±ador de informes:**

- Inicia el dise√±ador de informes de SSRS (SQL Server Data Tools o Report Builder).
- Abre el informe existente o crea uno nuevo.

2. **Agregar el pie de p√°gina y la cabecera:**

- Haz clic derecho en el √°rea del informe y selecciona "Propiedades del informe".
- En las propiedades del informe, selecciona la pesta√±a "Encabezado y pie de p√°gina".
- Activa la opci√≥n "Mostrar encabezado" y/o "Mostrar pie de p√°gina" seg√∫n tus necesidades.
- En el √°rea de dise√±o, aparecer√°n una cabecera y un pie de p√°gina predeterminados.

3. **Personalizar el contenido de la cabecera y el pie de p√°gina:**

- Haz clic en la cabecera o el pie de p√°gina en el √°rea de dise√±o para seleccionarlo.
- Utiliza las herramientas de formato y dise√±o para agregar texto, im√°genes o elementos adicionales seg√∫n tus necesidades.
- Puedes agregar elementos est√°ticos, como t√≠tulos o logotipos, utilizando las herramientas de dise√±o del informe.
- Tambi√©n puedes agregar elementos din√°micos, como n√∫meros de p√°gina o fechas, utilizando expresiones o variables.

4. **Configurar propiedades adicionales:**

- Haz clic derecho en la cabecera o el pie de p√°gina y selecciona "Propiedades del objeto".
- En las propiedades, puedes ajustar la altura, el ancho, el alineamiento y otras opciones para personalizar la apariencia.

5. **Previsualizar el informe:**

- Guarda el informe y previsual√≠zalo para ver c√≥mo se muestra el encabezado y el pie de p√°gina en las diferentes p√°ginas.
- Aseg√∫rate de que la informaci√≥n en el encabezado y el pie de p√°gina se actualice correctamente en todas las p√°ginas, como los n√∫meros de p√°gina consecutivos.

Aqu√≠ tienes un ejemplo de c√≥mo se ver√≠a un informe con pie de p√°gina y cabecera en SSRS:

```
-----------------------------------
|          T√≠tulo del informe      |
-----------------------------------
|      Cabecera personalizada      |
-----------------------------------
|    Datos del informe              |
|    ...
|    ...
|    ...
|                                  |
|                                  |
|    ...
|    ...
|                                  |
|                                  |
|                                  |
-----------------------------------
|   Pie de p√°gina personalizado    |
-----------------------------------
```

En este ejemplo, el informe tiene un t√≠tulo en la parte superior, seguido de una cabecera personalizada que muestra informaci√≥n adicional. El cuerpo del informe contiene los datos y se extiende a lo largo de m√∫ltiples p√°ginas. En la parte inferior de cada p√°gina, se muestra un pie de p√°gina personalizado, que puede incluir n√∫meros de p√°gina, fechas u otra informaci√≥n relevante.

Recuerda que las opciones y configuraciones espec√≠ficas pueden variar seg√∫n la versi√≥n y la herramienta que est√©s utilizando para crear informes. Sin embargo, el concepto b√°sico de aplicar pie de p√°gina y cabecera sigue siendo el mismo.

[üîº](#√≠ndice)

---

| **Inicio**               | **atr√°s 7**                                         |
| ------------------------ | --------------------------------------------------- |
| [üè†](../../../README.md) | [‚è™](./7.MODELAMIENTO_MULTIDIMENSIONAL_CON_SSAS.md) |
