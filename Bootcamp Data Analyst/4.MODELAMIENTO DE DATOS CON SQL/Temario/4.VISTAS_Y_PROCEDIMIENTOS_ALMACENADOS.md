| **Inicio**               | **atr谩s 3**                                       | **Siguiente 5**                                   |
| ------------------------ | ------------------------------------------------- | ------------------------------------------------- |
| [](../../../README.md) | [](./3.MANIPULACION_DE_DATOS_CON_SQL_SERVER.md) | [](./5.INTELIGENCIA_DE_NEGOCIOS_CON_MS_2019.md) |

---

## **ndice**

| Temario                                                                                                                                                                |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| [Creaci贸n de vistas](#creaci贸n-de-vistas)                                                                                                                              |
| [Procedimientos almacenados](#procedimientos-almacenados)                                                                                                              |
| [Automatizaci贸n a trav茅s de procedimientos almacenados, ejecuci贸n y administraci贸n](#automatizaci贸n-a-trav茅s-de-procedimientos-almacenados-ejecuci贸n-y-administraci贸n) |
| [Revisi贸n de modelamiento de datos bajo un enfoque de inteligencia de negocios](#revisi贸n-de-modelamiento-de-datos-bajo-un-enfoque-de-inteligencia-de-negocios)        |

---

# **4. VISTAS Y PROCEDIMIENTOS ALMACENADOS**

---

## **Creaci贸n de vistas**

La creaci贸n de vistas en SQL Server permite definir consultas predefinidas que se almacenan en la base de datos y se pueden utilizar como tablas virtuales en consultas posteriores. Una vista es una representaci贸n l贸gica de los datos de una o m谩s tablas y proporciona una forma conveniente de acceder a datos espec铆ficos sin tener que escribir la consulta completa cada vez. A continuaci贸n, te proporcionar茅 una explicaci贸n detallada de c贸mo crear vistas en SQL Server con ejemplos utilizando la base de datos Northwind.

Antes de continuar, aseg煤rate de tener la base de datos Northwind instalada en tu servidor SQL Server.

1. **Sintaxis b谩sica de la creaci贸n de vistas:**

La sintaxis b谩sica para crear una vista en SQL Server es la siguiente:

```
CREATE VIEW [NombreVista] AS
SELECT columna1, columna2, ...
FROM tabla1
JOIN tabla2 ON condicion
WHERE condicion;
```

**Ejemplo de creaci贸n de vista:**

Supongamos que deseas crear una vista que muestre los nombres y pa铆ses de los clientes de la tabla "`Customers`" de la base de datos Northwind. Puedes utilizar la siguiente sintaxis:

```
CREATE VIEW VistaClientes AS
SELECT ContactName AS NombreCliente, Country AS Pais
FROM Customers;
```

En este ejemplo, la vista se llama "`VistaClientes`" y se seleccionan las columnas `ContactName` y `Country` de la tabla "`Customers`". Estas columnas se renombran como "`NombreCliente`" y "`Pais`" respectivamente en la vista.

2. **Uso de una vista:**

Una vez que se ha creado una vista, se puede utilizar en consultas posteriores como si fuera una tabla virtual. Por ejemplo, puedes consultar la vista "`VistaClientes`" para obtener los nombres y pa铆ses de los clientes de la siguiente manera:

```
SELECT *
FROM VistaClientes;
```

Esta consulta seleccionar谩 todos los registros de la vista "`VistaClientes`" y mostrar谩 los nombres y pa铆ses de los clientes.

3. **Actualizaci贸n de una vista:**

En SQL Server, las vistas pueden ser actualizables o no actualizables, dependiendo de la forma en que se crean y de las operaciones permitidas en las tablas subyacentes. Las vistas no actualizables se utilizan principalmente para consultas de solo lectura. Las vistas actualizables permiten realizar operaciones de inserci贸n, actualizaci贸n y eliminaci贸n en la vista, y los cambios se reflejan en las tablas subyacentes.
En la base de datos Northwind, algunas tablas est谩n configuradas para admitir actualizaciones, mientras que otras no. Por lo tanto, debes tener en cuenta las restricciones de actualizaci贸n al trabajar con vistas en esta base de datos.

Estos son solo conceptos b谩sicos sobre la creaci贸n y uso de vistas en SQL Server. Puedes explorar m谩s opciones y funcionalidades en la documentaci贸n de SQL Server para adaptarlas a tus necesidades espec铆ficas.

Recuerda que debes conectarte a la base de datos Northwind en tu servidor SQL Server antes de ejecutar estas consultas.

[](#铆ndice)

---

## **Procedimientos almacenados**

Los procedimientos almacenados en SQL Server son bloques de c贸digo SQL predefinidos que se almacenan en la base de datos y se pueden llamar y ejecutar varias veces. Los procedimientos almacenados se utilizan para agrupar una serie de instrucciones SQL en una 煤nica unidad l贸gica, lo que facilita su reutilizaci贸n, mantenimiento y seguridad. A continuaci贸n, te proporcionar茅 una explicaci贸n detallada de c贸mo crear y utilizar procedimientos almacenados en SQL Server con ejemplos utilizando la base de datos Northwind.

Antes de continuar, aseg煤rate de tener la base de datos Northwind instalada en tu servidor SQL Server.

1. **Sintaxis b谩sica de creaci贸n de procedimientos almacenados:**

La sintaxis b谩sica para crear un procedimiento almacenado en SQL Server es la siguiente:

```
CREATE PROCEDURE [NombreProcedimiento]
AS
BEGIN
    -- Declaraciones y l贸gica del procedimiento
END;
```

**Ejemplo de creaci贸n de un procedimiento almacenado:**

Supongamos que deseas crear un procedimiento almacenado que devuelva todos los pedidos realizados por un cliente espec铆fico en la tabla "`Orders`" de la base de datos Northwind. Puedes utilizar la siguiente sintaxis:

```
CREATE PROCEDURE GetCustomerOrders
    @CustomerID nchar(5)
AS
BEGIN
    SELECT *
    FROM Orders
    WHERE CustomerID = @CustomerID;
END;
```

En este ejemplo, el procedimiento almacenado se llama "`GetCustomerOrders`" y toma un par谩metro de entrada "`@CustomerID`" que representa el `ID` del cliente. La l贸gica del procedimiento simplemente selecciona todos los pedidos de la tabla "`Orders`" que coinciden con el `ID` de cliente proporcionado.

2. **Ejecuci贸n de un procedimiento almacenado:**

Una vez que se ha creado un procedimiento almacenado, se puede ejecutar utilizando la siguiente sintaxis:

`EXEC [NombreProcedimiento] [Par谩metros];`

Para ejecutar el procedimiento almacenado "`GetCustomerOrders`" y obtener los pedidos del cliente con `ID` "`ALFKI`", puedes utilizar el siguiente comando:

`EXEC GetCustomerOrders @CustomerID = 'ALFKI';`

3. **Modificaci贸n y eliminaci贸n de procedimientos almacenados:**

Para modificar un procedimiento almacenado existente, puedes utilizar la declaraci贸n `ALTER PROCEDURE`. Por ejemplo:

```
ALTER PROCEDURE GetCustomerOrders
    @CustomerID nchar(5),
    @OrderDate datetime
AS
BEGIN
    SELECT *
    FROM Orders
    WHERE CustomerID = @CustomerID
    AND OrderDate > @OrderDate;
END;
```

Para eliminar un procedimiento almacenado, puedes utilizar la declaraci贸n `DROP PROCEDURE`. Por ejemplo:

`DROP PROCEDURE GetCustomerOrders;`

Estos son solo conceptos b谩sicos sobre la creaci贸n y uso de procedimientos almacenados en SQL Server. Puedes explorar m谩s opciones y funcionalidades, como par谩metros de salida, transacciones y control de errores, en la documentaci贸n de SQL Server para adaptarlos a tus necesidades espec铆ficas.

Recuerda que debes conectarte a la base de datos Northwind en tu servidor SQL Server antes de ejecutar estos comandos.

[](#铆ndice)

---

## **Automatizaci贸n a trav茅s de procedimientos almacenados, ejecuci贸n y administraci贸n**

La automatizaci贸n a trav茅s de procedimientos almacenados en SQL Server se refiere al uso de estos objetos para ejecutar tareas y procesos de forma programada y autom谩tica. Los procedimientos almacenados permiten centralizar la l贸gica de negocios y la l贸gica de procesamiento en la base de datos, lo que facilita su ejecuci贸n y administraci贸n. A continuaci贸n, te proporcionar茅 una explicaci贸n detallada de c贸mo puedes utilizar la automatizaci贸n a trav茅s de procedimientos almacenados en SQL Server, junto con ejemplos.

1. **Automatizaci贸n de tareas:**

Los procedimientos almacenados se pueden utilizar para automatizar diversas tareas, como la carga de datos, la generaci贸n de informes, la actualizaci贸n de registros y la programaci贸n de tareas recurrentes. Estas tareas se pueden ejecutar de forma programada utilizando un programador de tareas del sistema operativo o mediante eventos espec铆ficos en la base de datos.

**Ejemplo 1:** Crear un procedimiento almacenado que actualice el precio de todos los productos en la tabla "`Products`" en un cierto porcentaje.

```
CREATE PROCEDURE UpdateProductPrices
    @Percentage decimal(5,2)
AS
BEGIN
    UPDATE Products
    SET UnitPrice = UnitPrice * (1 + @Percentage);
END;
```

En este ejemplo, el procedimiento almacenado "`UpdateProductPrices`" recibe un par谩metro de entrada "`@Percentage`" que representa el porcentaje de aumento. Al ejecutar este procedimiento, se actualizar谩n los precios de todos los productos en la tabla "`Products`".

**Ejemplo 2:** Crear un procedimiento almacenado que genere un informe de ventas mensuales y lo almacene en una tabla de informes.

```
CREATE PROCEDURE GenerateMonthlySalesReport
AS
BEGIN
    INSERT INTO SalesReports (Month, TotalSales)
    SELECT DATEPART(MONTH, OrderDate), SUM(TotalAmount)
    FROM Orders
    GROUP BY DATEPART(MONTH, OrderDate);
END;
```

En este ejemplo, el procedimiento almacenado "`GenerateMonthlySalesReport`" inserta los datos de ventas mensuales en una tabla "`SalesReports`". Al ejecutar este procedimiento, se generar谩 un informe de ventas mensuales basado en los datos de la tabla "`Orders`".

2. **Ejecuci贸n de procedimientos almacenados:**

Para ejecutar un procedimiento almacenado de forma manual, puedes utilizar la siguiente sintaxis:

`EXEC [NombreProcedimiento] [Par谩metros];`

Por ejemplo, para ejecutar el procedimiento almacenado "`UpdateProductPrices`" con un aumento del 10% en los precios de los productos, puedes utilizar el siguiente comando:

`EXEC UpdateProductPrices @Percentage = 0.10;`

3. **Administraci贸n de procedimientos almacenados:**

Los procedimientos almacenados se pueden administrar en SQL Server mediante la creaci贸n, modificaci贸n y eliminaci贸n de los mismos. Tambi茅n puedes utilizar herramientas de administraci贸n y monitoreo para realizar un seguimiento de la ejecuci贸n de los procedimientos almacenados, analizar su rendimiento y optimizar su c贸digo.

**Ejemplo:** Utilizar la vista del cat谩logo del sistema "`sys.procedures`" para obtener informaci贸n sobre los procedimientos almacenados en la base de datos.

```
SELECT name, create_date, modify_date
FROM sys.procedures;
```

En este ejemplo, la consulta devuelve el nombre, la fecha de creaci贸n y la fecha de modificaci贸n de todos los procedimientos almacenados en la base de datos.

Recuerda que la automatizaci贸n a trav茅s de procedimientos almacenados puede ayudar a mejorar la eficiencia y consistencia de las tareas en la base de datos. Sin embargo, es importante planificar y probar adecuadamente los procedimientos almacenados antes de implementarlos en un entorno de producci贸n.

Espero que esta explicaci贸n te haya sido 煤til. Si tienes m谩s preguntas, no dudes en hacerlas.

[](#铆ndice)

---

## **Revisi贸n de modelamiento de datos bajo un enfoque de inteligencia de negocios**

La revisi贸n de modelamiento de datos bajo un enfoque de inteligencia de negocios se refiere al an谩lisis cr铆tico y mejora de la estructura y dise帽o de las bases de datos utilizadas en proyectos de inteligencia de negocios. El objetivo principal de esta revisi贸n es asegurar que el modelamiento de datos sea 贸ptimo para el an谩lisis y la generaci贸n de informaci贸n relevante para la toma de decisiones. A continuaci贸n, te proporcionar茅 una explicaci贸n detallada de la revisi贸n de modelamiento de datos en el contexto de la inteligencia de negocios, junto con ejemplos.

1. **Identificaci贸n de los requerimientos de informaci贸n:**

El primer paso en la revisi贸n de modelamiento de datos es comprender los requerimientos de informaci贸n de la organizaci贸n. Esto implica identificar qu茅 tipo de datos son necesarios para el an谩lisis de negocios, qu茅 preguntas se deben responder y qu茅 informaci贸n es relevante para la toma de decisiones. Estos requerimientos se traducen en dimensiones, m茅tricas y relaciones que se deben considerar en el modelamiento de datos.

**Ejemplo:** Supongamos que una empresa de comercio electr贸nico desea analizar las ventas por categor铆a de producto, regi贸n y per铆odo de tiempo. Los requerimientos de informaci贸n incluir铆an las dimensiones "`Categor铆a`", "`Regi贸n`" y "`Fecha`" y las m茅tricas como "`Ventas totales`" y "`Cantidad de pedidos`".

2. **Evaluaci贸n del modelo de datos existente:**

Una vez que se comprenden los requerimientos de informaci贸n, se debe evaluar el modelo de datos existente para determinar si cumple con esos requerimientos de manera eficiente y efectiva. Se analizan las tablas, relaciones, atributos y restricciones del modelo de datos para identificar posibles problemas o 谩reas de mejora.

**Ejemplo:** En un modelo de datos existente, se puede identificar que la informaci贸n de ventas se encuentra dispersa en varias tablas y no existe una estructura consolidada para el an谩lisis. Esto puede dificultar el proceso de extracci贸n de informaci贸n relevante y afectar la eficiencia del an谩lisis.

2. **Dise帽o de un modelo de datos optimizado:**

Una vez identificados los problemas o 谩reas de mejora en el modelo de datos existente, se procede a dise帽ar un modelo de datos optimizado que cumpla con los requerimientos de informaci贸n de manera m谩s efectiva. Esto implica realizar cambios en la estructura, relaciones y atributos del modelo de datos para facilitar el an谩lisis y la generaci贸n de informaci贸n relevante.

**Ejemplo:** En el ejemplo anterior, se podr铆a dise帽ar un modelo de datos optimizado que tenga una tabla central de ventas que contenga la informaci贸n relevante para el an谩lisis, incluyendo las dimensiones "`Categor铆a`", "`Regi贸n`" y "`Fecha`", as铆 como las m茅tricas de ventas. Esto simplificar铆a el proceso de an谩lisis y mejorar铆a la eficiencia del mismo.

3. **Validaci贸n y ajuste del modelo de datos:**

Una vez dise帽ado el modelo de datos optimizado, se realiza una validaci贸n exhaustiva del mismo para asegurar que cumpla con los requerimientos de informaci贸n y que los resultados obtenidos sean consistentes y confiables. Se realizan pruebas y ajustes adicionales en caso de ser necesario.

**Ejemplo:** En el ejemplo mencionado, se realizar铆an pruebas para verificar que el modelo de datos optimizado permite obtener informaci贸n precisa y coherente sobre las ventas por categor铆a de producto, regi贸n y per铆odo de tiempo.

La revisi贸n de modelamiento de datos bajo un enfoque de inteligencia de negocios es un proceso iterativo y continuo. A medida que evolucionan los requerimientos de informaci贸n y cambian las necesidades de an谩lisis, es necesario revisar y ajustar el modelo de datos para garantizar su relevancia y eficacia.

Espero que esta explicaci贸n te haya sido 煤til. Si tienes m谩s preguntas, no dudes en hacerlas.

[](#铆ndice)

---

| **Inicio**               | **atr谩s 3**                                       | **Siguiente 5**                                   |
| ------------------------ | ------------------------------------------------- | ------------------------------------------------- |
| [](../../../README.md) | [](./3.MANIPULACION_DE_DATOS_CON_SQL_SERVER.md) | [](./5.INTELIGENCIA_DE_NEGOCIOS_CON_MS_2019.md) |
