| **Inicio**            | **atr谩s 11**                 | **Siguiente 13**            |
| --------------------- | ---------------------------- | --------------------------- |
| [](../../README.md) | [](./11.Sentencias_SQL.md) | [](./13.Transacciones.md) |

---

## **ndice**

| Temario                                                       |
| ------------------------------------------------------------- |
| [Funciones LEFT y RIGHT](#funciones-left-y-right)             |
| [Funci贸n LEN](#funci贸n-len)                                   |
| [Funciones LOWER y UPPER](#funciones-lower-y-upper)           |
| [Funci贸n REPLACE](#funci贸n-replace)                           |
| [Funci贸n REPLICATE](#funci贸n-replicate)                       |
| [Funciones LTRIM y RTRIM](#funciones-ltrim-y-rtrim)           |
| [Funci贸n CONCAT](#funci贸n-concat)                             |
| [Funci贸n GETDATE y GETUTCDATE](#funci贸n-getdate-y-getutcdate) |
| [Funci贸n DATEADD](#funci贸n-dateadd)                           |
| [Funci贸n DATEDIFF](#funci贸n-datediff)                         |
| [Funci贸n DATEPART](#funci贸n-datepart)                         |
| [Funci贸n ISDATE](#funci贸n-isdate)                             |
| [Funciones CAST y CONVERT](#funciones-cast-y-convert)         |

---

# **Funciones de conversi贸n y texto**

---

## **Funciones LEFT y RIGHT**

Las funciones `LEFT` y `RIGHT` en SQL Server son funciones de cadena que se utilizan para extraer una parte espec铆fica de una cadena de texto. La funci贸n `LEFT` devuelve un n煤mero espec铆fico de caracteres desde el lado izquierdo de la cadena, mientras que la funci贸n `RIGHT` devuelve un n煤mero espec铆fico de caracteres desde el lado derecho de la cadena.

Aqu铆 tienes una explicaci贸n detallada de cada una de estas funciones, junto con ejemplos utilizando la base de datos Northwind:

1. **Funci贸n LEFT:**

La funci贸n `LEFT` se utiliza para extraer un n煤mero espec铆fico de caracteres desde el lado izquierdo de una cadena de texto. La sintaxis de la funci贸n `LEFT` es la siguiente:

`LEFT(cadena, longitud)`

- **cadena:** es la cadena de texto de la cual se extraer谩n los caracteres.
- **longitud:** es el n煤mero de caracteres que se extraer谩n desde el lado izquierdo de la cadena.

Ejemplo:

```
USE Northwind;
GO

SELECT LEFT(ContactName, 5) AS PrimerosCincoCaracteres
FROM Customers;
```

En este ejemplo, se utiliza la funci贸n `LEFT` para extraer los primeros cinco caracteres del campo "`ContactName`" en la tabla "`Customers`". Esto devolver谩 los primeros cinco caracteres de cada nombre de contacto en la tabla.

2. **Funci贸n RIGHT:**

La funci贸n `RIGHT` se utiliza para extraer un n煤mero espec铆fico de caracteres desde el lado derecho de una cadena de texto. La sintaxis de la funci贸n `RIGHT` es la siguiente:

`RIGHT(cadena, longitud)`

- **cadena:** es la cadena de texto de la cual se extraer谩n los caracteres.
- **longitud:** es el n煤mero de caracteres que se extraer谩n desde el lado derecho de la cadena.

Ejemplo:

```
USE Northwind;
GO

SELECT RIGHT(Phone, 4) AS UltimosCuatroDigitos
FROM Suppliers;
```

En este ejemplo, se utiliza la funci贸n `RIGHT` para extraer los 煤ltimos cuatro d铆gitos del campo "`Phone`" en la tabla "`Suppliers`". Esto devolver谩 los 煤ltimos cuatro d铆gitos de cada n煤mero de tel茅fono en la tabla.

Estas funciones son 煤tiles cuando se necesita extraer una parte espec铆fica de una cadena de texto, como los primeros caracteres de un nombre o los 煤ltimos d铆gitos de un n煤mero de tel茅fono. Pueden ser utilizadas en las cl谩usulas `SELECT`, `WHERE` y otras cl谩usulas de consulta para manipular y filtrar datos de manera efectiva.

Es importante tener en cuenta que tanto la funci贸n `LEFT` como la funci贸n `RIGHT` trabajan con cadenas de texto y devuelven una nueva cadena con la parte extra铆da. La longitud especificada debe ser un valor num茅rico y debe estar dentro del rango de la longitud de la cadena original.

Recuerda que estas funciones est谩n disponibles en SQL Server, pero pueden variar ligeramente en otros sistemas de gesti贸n de bases de datos.

[](#铆ndice)

---

## **Funci贸n LEN**

La funci贸n `LEN` en SQL Server se utiliza para obtener la longitud (n煤mero de caracteres) de una cadena de texto. Esta funci贸n retorna un n煤mero entero que representa la cantidad de caracteres en la cadena.

Aqu铆 tienes una explicaci贸n detallada de la funci贸n `LEN`, junto con un ejemplo utilizando la base de datos Northwind:

La sintaxis de la funci贸n `LEN` es la siguiente:

`LEN(cadena)`

- **cadena:** es la cadena de texto de la cual se desea obtener la longitud.

Ejemplo:

```
USE Northwind;
GO

SELECT LEN(CompanyName) AS Longitud
FROM Customers;
```

En este ejemplo, se utiliza la funci贸n `LEN` para obtener la longitud del campo "`CompanyName`" en la tabla "`Customers`". Esto devolver谩 la cantidad de caracteres de cada nombre de la compa帽铆a en la tabla.

Es importante tener en cuenta que la funci贸n `LEN` solo cuenta los caracteres en una cadena de texto y no incluye espacios en blanco o caracteres especiales. Por ejemplo, si una cadena tiene un espacio al final, ese espacio no se contabiliza en la longitud.

La funci贸n `LEN` es 煤til en situaciones en las que necesitas conocer la longitud de una cadena de texto, como verificar si una columna cumple con una longitud m谩xima permitida o realizar c谩lculos basados en la longitud de los valores.

Recuerda que la funci贸n `LEN` est谩 disponible en SQL Server y es compatible con otros sistemas de gesti贸n de bases de datos. Sin embargo, las funciones similares pueden tener nombres ligeramente diferentes en otros sistemas.

[](#铆ndice)

---

## **Funciones LOWER y UPPER**

Las funciones `LOWER` y `UPPER` en SQL Server se utilizan para convertir el texto en min煤sculas y may煤sculas, respectivamente. Estas funciones son 煤tiles cuando se necesita normalizar o estandarizar el formato del texto almacenado en una base de datos.

Aqu铆 tienes una explicaci贸n detallada de cada una de estas funciones, junto con ejemplos utilizando la base de datos Northwind:

1. **Funci贸n LOWER:**

La funci贸n `LOWER` se utiliza para convertir un texto en min煤sculas. La sintaxis de la funci贸n `LOWER` es la siguiente:

`LOWER(cadena)`

- **cadena:** es la cadena de texto que se desea convertir a min煤sculas.

Ejemplo:

```
USE Northwind;
GO

SELECT LOWER(ContactName) AS ContactoEnMinusculas
FROM Customers;
```

En este ejemplo, se utiliza la funci贸n `LOWER` para convertir el campo "`ContactName`" en min煤sculas en la tabla "`Customers`". Esto devolver谩 el nombre de contacto en min煤sculas para cada registro de la tabla.

2. **Funci贸n UPPER:**

La funci贸n `UPPER` se utiliza para convertir un texto en may煤sculas. La sintaxis de la funci贸n `UPPER` es la siguiente:

`UPPER(cadena)`

- **cadena:** es la cadena de texto que se desea convertir a may煤sculas.

Ejemplo:

```
USE Northwind;
GO

SELECT UPPER(City) AS CiudadEnMayusculas
FROM Customers;
```

En este ejemplo, se utiliza la funci贸n `UPPER` para convertir el campo "`City`" en may煤sculas en la tabla "`Customers`". Esto devolver谩 el nombre de la ciudad en may煤sculas para cada registro de la tabla.

Estas funciones son 煤tiles cuando se necesita normalizar el formato del texto en una base de datos. Pueden ser utilizadas en las cl谩usulas `SELECT`, `WHERE` y otras cl谩usulas de consulta para manipular y comparar datos de manera efectiva, sin importar el formato original en el que se encuentren.

Es importante tener en cuenta que las funciones `LOWER` y `UPPER` solo afectan a los caracteres alfab茅ticos en una cadena de texto y no tienen ning煤n efecto en caracteres num茅ricos o especiales. Adem谩s, estas funciones son independientes del idioma y funcionar谩n correctamente en diferentes configuraciones regionales.

Recuerda que estas funciones est谩n disponibles en SQL Server y son compatibles con otros sistemas de gesti贸n de bases de datos. Sin embargo, las funciones similares pueden tener nombres ligeramente diferentes en otros sistemas.

[](#铆ndice)

---

## **Funci贸n REPLACE**

La funci贸n `REPLACE` en SQL Server se utiliza para reemplazar todas las apariciones de una subcadena espec铆fica dentro de una cadena de texto por otra subcadena. Esta funci贸n es 煤til cuando se necesita modificar o corregir datos almacenados en una base de datos.

Aqu铆 tienes una explicaci贸n detallada de la funci贸n `REPLACE`, junto con un ejemplo utilizando la base de datos Northwind:

La sintaxis de la funci贸n `REPLACE` es la siguiente:

`REPLACE(cadena, subcadena_a_reemplazar, nueva_subcadena)`

- **cadena:** es la cadena de texto en la que se realizar谩 el reemplazo.
- **subcadena_a_reemplazar:** es la subcadena que se buscar谩 en la cadena para ser reemplazada.
- **nueva_subcadena:** es la subcadena que se utilizar谩 como reemplazo.

Ejemplo:

```
USE Northwind;
GO

SELECT REPLACE(CompanyName, ' Inc.', ' Incorporated') AS CompaniaModificada
FROM Customers;
```

En este ejemplo, se utiliza la funci贸n `REPLACE` para reemplazar todas las apariciones de la subcadena " `Inc.`" en el campo "`CompanyName`" de la tabla "`Customers`" por la subcadena " `Incorporated`". Esto devolver谩 el nombre de la compa帽铆a modificado para cada registro de la tabla.

Es importante tener en cuenta que la funci贸n `REPLACE` realiza el reemplazo de manera sensible a may煤sculas y min煤sculas. Esto significa que distingue entre may煤sculas y min煤sculas al buscar la subcadena en la cadena original. Si se desea realizar un reemplazo insensible a may煤sculas y min煤sculas, se pueden utilizar combinaciones de las funciones `UPPER` y `LOWER` junto con la funci贸n `REPLACE`.

La funci贸n `REPLACE` es 煤til cuando se necesita corregir o modificar datos almacenados en una base de datos. Puede ser utilizada en las cl谩usulas `SELECT`, `UPDATE` y otras cl谩usulas de consulta para realizar reemplazos en tiempo real y garantizar la integridad y precisi贸n de los datos.

Recuerda que la funci贸n `REPLACE` est谩 disponible en SQL Server y es compatible con otros sistemas de gesti贸n de bases de datos. Sin embargo, las funciones similares pueden tener nombres ligeramente diferentes en otros sistemas.

[](#铆ndice)

---

## **Funci贸n REPLICATE**

La funci贸n `REPLICATE` en SQL Server se utiliza para repetir una cadena de texto un n煤mero determinado de veces. Esta funci贸n es 煤til cuando se necesita generar valores repetidos o rellenar campos con un patr贸n espec铆fico.

Aqu铆 tienes una explicaci贸n detallada de la funci贸n `REPLICATE`, junto con un ejemplo utilizando la base de datos Northwind:

La sintaxis de la funci贸n `REPLICATE` es la siguiente:

`REPLICATE(cadena, cantidad)`

- **cadena:** es la cadena de texto que se desea repetir.
- **cantidad:** es el n煤mero de veces que se desea repetir la cadena.

Ejemplo:

```
USE Northwind;
GO

SELECT REPLICATE('*', 10) AS Asteriscos
FROM Customers;
```

En este ejemplo, se utiliza la funci贸n `REPLICATE` para generar una cadena de texto que consiste en el car谩cter '`*`' repetido 10 veces. Esto devolver谩 una columna llamada "`Asteriscos`" con 10 asteriscos en cada fila de la tabla "`Customers`".

La funci贸n `REPLICATE` es especialmente 煤til cuando se combina con otras funciones y se utiliza en consultas o actualizaciones de datos. Por ejemplo, se puede utilizar para generar un n煤mero espec铆fico de espacios en blanco, completar campos con valores predeterminados o crear patrones repetitivos para generar datos de prueba.

Es importante tener en cuenta que la funci贸n `REPLICATE` no se limita a caracteres individuales y puede repetir cadenas de texto completas. Por lo tanto, se pueden generar patrones m谩s complejos utilizando cadenas m谩s largas.

Recuerda que la funci贸n `REPLICATE` est谩 disponible en SQL Server y es compatible con otros sistemas de gesti贸n de bases de datos. Sin embargo, las funciones similares pueden tener nombres ligeramente diferentes en otros sistemas.

[](#铆ndice)

---

## **Funciones LTRIM y RTRIM**

Las funciones `LTRIM` y `RTRIM` en SQL Server se utilizan para eliminar los espacios en blanco iniciales (`LTRIM`) y finales (`RTRIM`) de una cadena de texto, respectivamente. Estas funciones son 煤tiles cuando se necesita limpiar y normalizar los valores almacenados en una base de datos.

Aqu铆 tienes una explicaci贸n detallada de cada una de estas funciones, junto con ejemplos utilizando la base de datos Northwind:

1. **Funci贸n LTRIM:**

La funci贸n `LTRIM` se utiliza para eliminar los espacios en blanco iniciales de una cadena de texto. La sintaxis de la funci贸n `LTRIM` es la siguiente:

`LTRIM(cadena)`

- **cadena:** es la cadena de texto de la cual se eliminar谩n los espacios en blanco iniciales.

Ejemplo:

```
USE Northwind;
GO

SELECT LTRIM(ContactName) AS ContactoSinEspaciosIniciales
FROM Customers;
```

En este ejemplo, se utiliza la funci贸n `LTRIM` para eliminar los espacios en blanco iniciales del campo "`ContactName`" en la tabla "`Customers`". Esto devolver谩 el nombre de contacto sin espacios en blanco al principio para cada registro de la tabla.

2. **Funci贸n RTRIM:**

La funci贸n `RTRIM` se utiliza para eliminar los espacios en blanco finales de una cadena de texto. La sintaxis de la funci贸n `RTRIM` es la siguiente:

`RTRIM(cadena)`

- **cadena:** es la cadena de texto de la cual se eliminar谩n los espacios en blanco finales.

Ejemplo:

```
USE Northwind;
GO

SELECT RTRIM(ContactName) AS ContactoSinEspaciosFinales
FROM Customers;
```

En este ejemplo, se utiliza la funci贸n `RTRIM` para eliminar los espacios en blanco finales del campo "`ContactName`" en la tabla "`Customers`". Esto devolver谩 el nombre de contacto sin espacios en blanco al final para cada registro de la tabla.

Estas funciones son 煤tiles cuando se necesita limpiar y normalizar los valores de las cadenas de texto en una base de datos. Pueden ser utilizadas en las cl谩usulas `SELECT`, `WHERE` y otras cl谩usulas de consulta para manipular y comparar datos de manera efectiva, sin considerar los espacios en blanco innecesarios.

Es importante tener en cuenta que las funciones `LTRIM` y `RTRIM` solo eliminan los espacios en blanco iniciales y finales de una cadena de texto. Si se desean eliminar los espacios en blanco en cualquier posici贸n dentro de la cadena, se puede utilizar la funci贸n `REPLACE` junto con la funci贸n `LTRIM` o `RTRIM`.

Recuerda que estas funciones est谩n disponibles en SQL Server y son compatibles con otros sistemas de gesti贸n de bases de datos. Sin embargo, las funciones similares pueden tener nombres ligeramente diferentes en otros sistemas.

[](#铆ndice)

---

## **Funci贸n CONCAT**

La funci贸n `CONCAT` en SQL Server se utiliza para concatenar o unir varias cadenas de texto en una sola cadena. Esta funci贸n es 煤til cuando se necesita combinar datos de diferentes columnas o constantes en una expresi贸n de texto.

Aqu铆 tienes una explicaci贸n detallada de la funci贸n `CONCAT`, junto con un ejemplo utilizando la base de datos Northwind:

La sintaxis de la funci贸n `CONCAT` es la siguiente:

`CONCAT(valor1, valor2, ...)`

- **valor1, valor2, ...:** son los valores que se desean concatenar. Pueden ser columnas de la tabla, constantes o expresiones.

Ejemplo:

```
USE Northwind;
GO

SELECT CONCAT(FirstName, ' ', LastName) AS NombreCompleto
FROM Employees;
```

En este ejemplo, se utiliza la funci贸n `CONCAT` para combinar los valores de las columnas "`FirstName`" y "`LastName`" en la tabla "`Employees`" y generar una columna llamada "`NombreCompleto`" que contenga el nombre completo de cada empleado.

La funci贸n `CONCAT` permite concatenar m煤ltiples valores en el orden especificado y no requiere ning煤n separador adicional entre los valores. En el ejemplo anterior, se utiliza un espacio en blanco entre las columnas "`FirstName`" y "`LastName`" para separar los nombres y apellidos en la cadena resultante.

Es importante tener en cuenta que la funci贸n `CONCAT` maneja autom谩ticamente los valores `NULL` y los convierte en una cadena vac铆a. Esto significa que si alguno de los valores pasados a `CONCAT` es `NULL`, la funci贸n devolver谩 una cadena sin incluir ese valor `NULL`.

La funci贸n `CONCAT` es especialmente 煤til cuando se necesitan combinar datos de diferentes columnas en una 煤nica cadena, como en el ejemplo del nombre completo. Tambi茅n se puede utilizar para crear mensajes personalizados, generar identificadores 煤nicos o construir consultas din谩micas.

Recuerda que la funci贸n `CONCAT` est谩 disponible en SQL Server 2012 y versiones posteriores. Si est谩s utilizando una versi贸n anterior, puedes utilizar la funci贸n de concatenaci贸n m谩s antigua, que es el operador `+`. Sin embargo, la funci贸n `CONCAT` es preferible ya que proporciona un manejo m谩s robusto de los valores `NULL` y tiene una sintaxis m谩s clara.

[](#铆ndice)

---

## **Funci贸n GETDATE y GETUTCDATE**

La funci贸n `GETDATE` y `GETUTCDATE` en SQL Server se utilizan para obtener la fecha y hora actual en el sistema local y en el tiempo universal coordinado (UTC), respectivamente. Estas funciones son 煤tiles para registrar la fecha y hora en que se realizan operaciones, realizar c谩lculos de tiempo y generar valores de fecha y hora en consultas.

Aqu铆 tienes una explicaci贸n detallada de cada una de estas funciones, junto con ejemplos utilizando la base de datos Northwind:

1. **Funci贸n GETDATE:**

La funci贸n `GETDATE` se utiliza para obtener la fecha y hora actual en el sistema local. La sintaxis de la funci贸n `GETDATE` es la siguiente:

`GETDATE()`

Ejemplo:

```
USE Northwind;
GO

SELECT GETDATE() AS FechaYHoraLocal;
```

En este ejemplo, se utiliza la funci贸n `GETDATE` para obtener la fecha y hora actual del sistema local y se muestra en una columna llamada "`FechaYHoraLocal`".

2. **Funci贸n GETUTCDATE:**

La funci贸n `GETUTCDATE` se utiliza para obtener la fecha y hora actual en el tiempo universal coordinado (UTC). La sintaxis de la funci贸n `GETUTCDATE` es la siguiente:

`GETUTCDATE()`

Ejemplo:

```
USE Northwind;
GO

SELECT GETUTCDATE() AS FechaYHoraUTC;
```

En este ejemplo, se utiliza la funci贸n `GETUTCDATE` para obtener la fecha y hora actual en UTC y se muestra en una columna llamada "`FechaYHoraUTC`".

Es importante tener en cuenta que la funci贸n `GETDATE` devuelve la fecha y hora en la zona horaria del servidor SQL Server, que puede diferir de la zona horaria del cliente o del usuario. Si se necesita una consistencia en la zona horaria, se recomienda utilizar la funci贸n `GETUTCDATE` para obtener la fecha y hora en UTC y luego convertirla seg煤n sea necesario.

Estas funciones son 煤tiles para registrar la fecha y hora en que se realizan operaciones en la base de datos, generar valores de fecha y hora en consultas y realizar c谩lculos de tiempo, como la diferencia entre dos fechas.

Recuerda que estas funciones est谩n disponibles en SQL Server y son compatibles con otros sistemas de gesti贸n de bases de datos. Sin embargo, las funciones similares pueden tener nombres ligeramente diferentes en otros sistemas.

[](#铆ndice)

---

## **Funci贸n DATEADD**

La funci贸n `DATEADD` en SQL Server se utiliza para agregar o restar una cantidad espec铆fica de tiempo a una fecha y hora determinada. Esta funci贸n es 煤til cuando se necesita calcular nuevas fechas basadas en una fecha de origen y un intervalo de tiempo determinado.

Aqu铆 tienes una explicaci贸n detallada de la funci贸n `DATEADD`, junto con un ejemplo utilizando la base de datos Northwind:

La sintaxis de la funci贸n `DATEADD` es la siguiente:

`DATEADD(intervalo, cantidad, fecha)`

- **intervalo:** es la unidad de tiempo que se desea agregar o restar. Puede ser uno de los siguientes valores: year, quarter, month, day, week, hour, minute, second, millisecond, microsecond o nanosecond.
- **cantidad:** es la cantidad de intervalos de tiempo que se desea agregar o restar. Puede ser un valor positivo para agregar tiempo o un valor negativo para restar tiempo.
- **fecha:** es la fecha y hora de origen a la cual se le agregar谩n o restar谩n intervalos de tiempo.

Ejemplo:

```
USE Northwind;
GO

SELECT DATEADD(day, 7, OrderDate) AS FechaEntrega
FROM Orders;
```

En este ejemplo, se utiliza la funci贸n `DATEADD` para agregar 7 d铆as a la columna "`OrderDate`" en la tabla "`Orders`". Esto generar谩 una columna llamada "`FechaEntrega`" que mostrar谩 la fecha de entrega estimada de cada pedido, que es 7 d铆as despu茅s de la fecha de pedido original.

La funci贸n `DATEADD` permite realizar c谩lculos avanzados de fechas y es especialmente 煤til cuando se necesitan generar fechas futuras o pasadas basadas en una fecha de origen y un intervalo de tiempo. Puedes utilizar diferentes unidades de tiempo, como d铆as, meses, a帽os, horas, minutos, etc., seg煤n tus necesidades.

Adem谩s, la funci贸n `DATEADD` es flexible y puede combinar diferentes intervalos de tiempo para realizar c谩lculos m谩s complejos. Por ejemplo, puedes agregar a帽os y meses a una fecha o sumar horas y minutos a una hora espec铆fica.

Recuerda que la funci贸n `DATEADD` est谩 disponible en SQL Server y es compatible con otros sistemas de gesti贸n de bases de datos. Sin embargo, las funciones similares pueden tener nombres ligeramente diferentes en otros sistemas.

[](#铆ndice)

---

## **Funci贸n DATEDIFF**

La funci贸n `DATEDIFF` en SQL Server se utiliza para calcular la diferencia entre dos fechas en una unidad de tiempo espec铆fica. Esta funci贸n es 煤til cuando se necesita determinar la cantidad de tiempo transcurrido entre dos fechas, como la diferencia en d铆as, meses, a帽os, horas, minutos, etc.

Aqu铆 tienes una explicaci贸n detallada de la funci贸n `DATEDIFF`, junto con un ejemplo utilizando la base de datos Northwind:

La sintaxis de la funci贸n `DATEDIFF` es la siguiente:

`DATEDIFF(intervalo, fecha_inicio, fecha_fin)`

- \*\*intervalo: es la unidad de tiempo en la cual se desea calcular la diferencia entre las dos fechas. Puede ser uno de los siguientes valores: `year`, `quarter`, `month`, `day`, `week`, `hour`, `minute`, `second`, `millisecond`, `microsecond` o `nanosecond`.
- **fecha_inicio:** es la fecha y hora inicial del c谩lculo.
- **fecha_fin:** es la fecha y hora final del c谩lculo.

Ejemplo:

```
USE Northwind;
GO

SELECT DATEDIFF(day, OrderDate, ShippedDate) AS DiasTranscurridos
FROM Orders;
```

En este ejemplo, se utiliza la funci贸n `DATEDIFF` para calcular la diferencia en d铆as entre las columnas "`OrderDate`" y "`ShippedDate`" en la tabla "`Orders`". Esto generar谩 una columna llamada "`DiasTranscurridos`" que mostrar谩 la cantidad de d铆as que han pasado entre la fecha de pedido y la fecha de env铆o para cada pedido.

La funci贸n `DATEDIFF` permite calcular la diferencia entre dos fechas en diferentes unidades de tiempo, seg煤n las necesidades. Puedes obtener la diferencia en a帽os, meses, d铆as, horas, minutos, segundos, milisegundos, microsegundos o nanosegundos.

Es importante tener en cuenta que la funci贸n `DATEDIFF` devuelve un n煤mero entero que representa la diferencia en la unidad de tiempo especificada. Si necesitas una precisi贸n fraccionaria, puedes utilizar otras funciones de fecha y hora para realizar c谩lculos m谩s detallados.

Recuerda que la funci贸n `DATEDIFF` est谩 disponible en SQL Server y es compatible con otros sistemas de gesti贸n de bases de datos. Sin embargo, las funciones similares pueden tener nombres ligeramente diferentes en otros sistemas.

[](#铆ndice)

---

## **Funci贸n DATEPART**

La funci贸n `DATEPART` en SQL Server se utiliza para extraer una parte espec铆fica de una fecha o hora. Esta funci贸n es 煤til cuando se necesita obtener componentes individuales, como el a帽o, mes, d铆a, hora, minuto, etc., de una fecha o hora completa.

Aqu铆 tienes una explicaci贸n detallada de la funci贸n `DATEPART`, junto con un ejemplo utilizando la base de datos Northwind:

La sintaxis de la funci贸n `DATEPART` es la siguiente:

`DATEPART(intervalo, fecha)`

- **intervalo:** es la parte de la fecha que se desea extraer. Puede ser uno de los siguientes valores: year, quarter, month, day, week, hour, minute, second, millisecond, microsecond o nanosecond.
- **fecha:** es la fecha o hora de la cual se desea extraer la parte especificada.

Ejemplo:

```
USE Northwind;
GO

SELECT DATEPART(year, OrderDate) AS Anio,
       DATEPART(month, OrderDate) AS Mes,
       DATEPART(day, OrderDate) AS Dia
FROM Orders;
```

En este ejemplo, se utiliza la funci贸n `DATEPART` para extraer las partes individuales (a帽o, mes, d铆a) de la columna "`OrderDate`" en la tabla "`Orders`". Esto generar谩 tres columnas: "`Anio`" que contiene el a帽o de la fecha, "`Mes`" que contiene el n煤mero del mes y "`Dia`" que contiene el n煤mero del d铆a correspondiente a cada registro.

La funci贸n `DATEPART` permite extraer informaci贸n espec铆fica de una fecha o hora. Puedes utilizar diferentes intervalos para obtener diferentes partes, como el a帽o, mes, d铆a, hora, minuto, etc. Esto es 煤til cuando se necesita realizar c谩lculos o filtrar registros basados en partes espec铆ficas de una fecha o hora.

Es importante tener en cuenta que el valor devuelto por la funci贸n `DATEPART` ser谩 un n煤mero entero que representa la parte solicitada. Por ejemplo, para el intervalo "`month`", se devolver谩 un n煤mero entero del 1 al 12 que representa el mes correspondiente.

Recuerda que la funci贸n `DATEPART` est谩 disponible en SQL Server y es compatible con otros sistemas de gesti贸n de bases de datos. Sin embargo, las funciones similares pueden tener nombres ligeramente diferentes en otros sistemas.

[](#铆ndice)

---

## **Funci贸n ISDATE**

La funci贸n `ISDATE` en SQL Server se utiliza para verificar si una expresi贸n es una fecha v谩lida. Retorna 1 si la expresi贸n es una fecha v谩lida y 0 si no lo es. Esta funci贸n es 煤til cuando se necesita validar si un valor es una fecha antes de realizar operaciones o comparaciones relacionadas con fechas.

Aqu铆 tienes una explicaci贸n detallada de la funci贸n `ISDATE`, junto con un ejemplo utilizando la base de datos Northwind:

La sintaxis de la funci贸n `ISDATE` es la siguiente:

`ISDATE(expresion)`

- **expresion:** es la expresi贸n que se desea evaluar para determinar si es una fecha v谩lida o no.

Ejemplo:

```
USE Northwind;
GO

SELECT OrderID, OrderDate, ISDATE(OrderDate) AS EsFechaValida
FROM Orders;
```

En este ejemplo, se utiliza la funci贸n `ISDATE` para determinar si la columna "`OrderDate`" en la tabla "`Orders`" contiene valores de fecha v谩lidos. La funci贸n retorna 1 si la expresi贸n es una fecha v谩lida y 0 si no lo es. El resultado se muestra en una columna llamada "`EsFechaValida`".

Es importante tener en cuenta que la funci贸n `ISDATE` tiene en cuenta diversos formatos de fecha reconocidos por SQL Server para determinar si una expresi贸n es una fecha v谩lida. Sin embargo, es posible que la funci贸n no pueda reconocer formatos de fecha personalizados o interpretar correctamente fechas en formatos ambiguos.

La funci贸n `ISDATE` es 煤til para validar datos de fecha antes de realizar operaciones o comparaciones relacionadas con fechas. Puede utilizarse en consultas para filtrar registros basados en la validez de las fechas, evitando as铆 errores de tiempo de ejecuci贸n al realizar c谩lculos con datos no v谩lidos.

Recuerda que la funci贸n `ISDATE` est谩 disponible en SQL Server y es compatible con otros sistemas de gesti贸n de bases de datos. Sin embargo, las funciones similares pueden tener nombres ligeramente diferentes en otros sistemas.

[](#铆ndice)

---

## **Funciones CAST y CONVERT**

Las funciones `CAST` y `CONVERT` en SQL Server se utilizan para convertir un tipo de datos a otro. Estas funciones son 煤tiles cuando se necesita cambiar el tipo de datos de una columna o expresi贸n en una consulta.

Aqu铆 tienes una explicaci贸n detallada de las funciones `CAST` y `CONVERT`, junto con un ejemplo utilizando la base de datos Northwind:

La funci贸n `CAST` se utiliza para realizar conversiones de tipo de datos expl铆citas en SQL Server. La sintaxis de la funci贸n `CAST` es la siguiente:

`CAST(expresion AS tipo_de_dato)`

- expresion es la expresi贸n o columna que se desea convertir.
- tipo_de_dato es el tipo de datos al que se desea convertir la expresi贸n.

Ejemplo:

```
USE Northwind;
GO

SELECT OrderID, CAST(Quantity AS varchar(10)) AS CantidadTexto
FROM [Order Details];
```

En este ejemplo, se utiliza la funci贸n `CAST` para convertir la columna "`Quantity`" de la tabla "`Order Details`" en una cadena de texto (`varchar`). Esto genera una nueva columna llamada "`CantidadTexto`" que contiene la cantidad convertida como una cadena de texto.

La funci贸n `CONVERT` tambi茅n se utiliza para realizar conversiones de tipo de datos en SQL Server. La diferencia principal entre `CAST` y `CONVERT` es que `CONVERT` permite especificar un estilo de formato adicional para ciertos tipos de datos, como fechas y horas. La sintaxis de la funci贸n `CONVERT` es la siguiente:

`CONVERT(tipo_de_dato, expresion, estilo)`

- tipo_de_dato es el tipo de datos al que se desea convertir la expresi贸n.
- expresion es la expresi贸n o columna que se desea convertir.
- estilo (opcional) es un valor num茅rico que representa el estilo de formato para las conversiones de fecha y hora.

Ejemplo:

```
USE Northwind;
GO

SELECT OrderID, CONVERT(varchar(10), OrderDate, 103) AS FechaTexto
FROM Orders;
```

En este ejemplo, se utiliza la funci贸n `CONVERT` para convertir la columna "`OrderDate`" de la tabla "`Orders`" en una cadena de texto (varchar) con un estilo de formato espec铆fico (103). Esto genera una nueva columna llamada "`FechaTexto`" que contiene la fecha convertida como una cadena de texto en formato `DD/MM/AAAA`.

Tanto `CAST` como `CONVERT` son 煤tiles para cambiar el tipo de datos de una columna o expresi贸n en una consulta. Estas funciones permiten manipular y presentar los datos de una manera m谩s adecuada para las necesidades de la aplicaci贸n o el informe.

Recuerda que las funciones `CAST` y `CONVERT` est谩n disponibles en SQL Server y son compatibles con otros sistemas de gesti贸n de bases de datos. Sin embargo, las funciones similares pueden tener nombres ligeramente diferentes en otros sistemas.

[](#铆ndice)

---

| **Inicio**            | **atr谩s 11**                 | **Siguiente 13**            |
| --------------------- | ---------------------------- | --------------------------- |
| [](../../README.md) | [](./11.Sentencias_SQL.md) | [](./13.Transacciones.md) |
