| **Inicio**            | **atr√°s 13**                | **Siguiente 15**                                 |
| --------------------- | --------------------------- | ------------------------------------------------ |
| [üè†](../../README.md) | [‚è™](./13.Transacciones.md) | [‚è©](./15.Funciones_definidas_por_el_Usuario.md) |

---

## **√çndice**

| Temario                                                                                                         |
| --------------------------------------------------------------------------------------------------------------- |
| [Introducci√≥n](#introducci√≥n)                                                                                   |
| [La cl√°usula INNER JOIN](#la-cl√°usula-inner-join)                                                               |
| [Consideraciones a tener en cuenta con el uso de INNER](#consideraciones-a-tener-en-cuenta-con-el-uso-de-inner) |
| [La cl√°usula UNION y UNION ALL](#la-cl√°usula-union-y-union-all)                                                 |

---

# **JOIN y UNIONS entre tablas**

---

## **Introducci√≥n**

Los `JOIN` y `UNIONS` son operaciones utilizadas en SQL Server para combinar datos de m√∫ltiples tablas. Aunque tienen prop√≥sitos diferentes, ambos son fundamentales para realizar consultas complejas y obtener conjuntos de resultados m√°s completos.

Aqu√≠ tienes una explicaci√≥n detallada de los `JOIN` y `UNIONS`, junto con ejemplos utilizando la base de datos Northwind:

1. **JOIN:**

Los `JOIN` se utilizan para combinar registros relacionados de dos o m√°s tablas en funci√≥n de una condici√≥n de uni√≥n. Hay diferentes tipos de `JOIN` disponibles en SQL Server, que incluyen `INNER JOIN`, `LEFT JOIN`, `RIGHT JOIN` y `FULL JOIN`. Estos tipos de `JOIN` determinan c√≥mo se combinan los registros y qu√© registros se incluyen en el resultado final.

- Ejemplo de `INNER JOIN`:

```
USE Northwind;
GO

SELECT Orders.OrderID, Customers.ContactName
FROM Orders
INNER JOIN Customers ON Orders.CustomerID = Customers.CustomerID;
```

En este ejemplo, se realiza un `INNER JOIN` entre las tablas "`Orders`" y "`Customers`" utilizando la columna "`CustomerID`" como condici√≥n de uni√≥n. El resultado muestra el `OrderID` y el `ContactName` de los registros que tienen una coincidencia en ambas tablas.

2. **UNION:**

Los `UNION` se utilizan para combinar el resultado de dos o m√°s consultas en un solo conjunto de resultados. Las consultas deben tener la misma estructura de columna para poder realizar un `UNION`. Las duplicaciones de registros se eliminan autom√°ticamente a menos que se utilice `UNION ALL`, que conserva todas las filas, incluso las duplicadas.

- Ejemplo de `UNION`:

```
USE Northwind;
GO

SELECT CustomerID, ContactName
FROM Customers
WHERE Country = 'Germany'

UNION

SELECT CustomerID, ContactName
FROM Customers
WHERE Country = 'France';
```

En este ejemplo, se realizan dos consultas para obtener los clientes de Alemania y Francia respectivamente. Las dos consultas tienen la misma estructura de columna, por lo que se utiliza `UNION` para combinar los resultados en un √∫nico conjunto de resultados.

Es importante destacar que el n√∫mero y el orden de las columnas deben ser los mismos en todas las consultas que se utilizan en el `UNION`.

Tanto los `JOIN` como los `UNIONS` son herramientas poderosas para combinar y relacionar datos de diferentes tablas en SQL Server. Los `JOIN` permiten obtener resultados basados en condiciones de uni√≥n espec√≠ficas, mientras que los `UNIONS` permiten combinar el resultado de consultas similares. Ambos se utilizan ampliamente para realizar consultas complejas y obtener conjuntos de resultados m√°s completos y relevantes.

Recuerda que los `JOIN` y `UNIONS` son operaciones est√°ndar en SQL Server y son compatibles con otros sistemas de gesti√≥n de bases de datos. Sin embargo, es posible que algunas sintaxis y caracter√≠sticas espec√≠ficas var√≠en entre los diferentes sistemas.

[üîº](#√≠ndice)

---

## **La cl√°usula INNER JOIN**

La cl√°usula `INNER JOIN` en SQL Server se utiliza para combinar registros de dos o m√°s tablas en funci√≥n de una condici√≥n de uni√≥n. Se seleccionan solo los registros que tienen una coincidencia en ambas tablas involucradas en la operaci√≥n `JOIN`.

Aqu√≠ tienes una explicaci√≥n detallada de la cl√°usula `INNER JOIN`, junto con un ejemplo utilizando la base de datos Northwind:

La sintaxis b√°sica de la cl√°usula `INNER JOIN` es la siguiente:

```
SELECT columnas
FROM tabla1
INNER JOIN tabla2
   ON tabla1.columna = tabla2.columna;
```

- "`columnas`" representa las columnas espec√≠ficas que deseas seleccionar de las tablas involucradas en el `JOIN`.
- "`tabla1`" y "`tabla2`" son las tablas que deseas combinar mediante el `JOIN`.
- "`columna`" es la columna com√∫n utilizada para realizar la uni√≥n entre las tablas.

Ejemplo:

```
USE Northwind;
GO

SELECT Orders.OrderID, Customers.ContactName
FROM Orders
INNER JOIN Customers ON Orders.CustomerID = Customers.CustomerID;
```

En este ejemplo, se realiza un `INNER JOIN` entre las tablas "`Orders`" y "`Customers`" utilizando la columna "`CustomerID`" como condici√≥n de uni√≥n. La cl√°usula `ON` establece la relaci√≥n entre las tablas, especificando que los registros deben tener el mismo valor en la columna "`CustomerID`" para ser incluidos en el resultado.

El resultado de esta consulta mostrar√° el `OrderID` y el `ContactName` de los registros que tienen una coincidencia en ambas tablas. Solo se seleccionar√°n los registros que cumplan con la condici√≥n de uni√≥n establecida en el `INNER JOIN`.

La cl√°usula `INNER JOIN` es √∫til cuando se necesita combinar registros de dos o m√°s tablas bas√°ndose en una relaci√≥n definida. Esto permite obtener informaci√≥n relacionada de diferentes tablas en una sola consulta. Es una forma efectiva de aprovechar las relaciones definidas en la estructura de la base de datos para obtener resultados m√°s completos y relevantes.

Recuerda que la cl√°usula `INNER JOIN` es una funcionalidad est√°ndar en SQL Server y es compatible con otros sistemas de gesti√≥n de bases de datos. Sin embargo, las sintaxis y caracter√≠sticas espec√≠ficas pueden variar entre los diferentes sistemas.

[üîº](#√≠ndice)

---

## **Consideraciones a tener en cuenta con el uso de INNER**

Al utilizar la cl√°usula `INNER JOIN` en SQL Server, es importante tener en cuenta algunas consideraciones para garantizar resultados correctos y eficientes. Aqu√≠ tienes una explicaci√≥n detallada de las consideraciones al usar `INNER JOIN`, junto con un ejemplo utilizando la base de datos Northwind:

1. **Coincidencia de claves:**

La condici√≥n de uni√≥n en el `INNER JOIN` debe basarse en columnas que contengan claves relacionadas entre las tablas. Aseg√∫rate de que las columnas utilizadas para la uni√≥n sean del mismo tipo de datos y tengan valores coincidentes en ambas tablas. De lo contrario, los resultados pueden ser inexactos o incompletos.

Ejemplo:

```
USE Northwind;
GO

SELECT Orders.OrderID, Customers.ContactName
FROM Orders
INNER JOIN Customers ON Orders.CustomerID = Customers.CustomerID;
```

En este ejemplo, la condici√≥n de uni√≥n se basa en la columna "`CustomerID`" en las tablas "`Orders`" y "`Customers`". Ambas columnas deben ser del mismo tipo de datos y contener valores coincidentes para obtener resultados precisos.

2. **Tablas relacionadas correctamente:**

Aseg√∫rate de que las tablas involucradas en el `INNER JOIN` est√©n relacionadas correctamente en la base de datos. Esto se logra mediante la definici√≥n adecuada de las claves primarias y for√°neas en las tablas relacionadas. Verifica las relaciones establecidas entre las tablas para asegurarte de que el `INNER JOIN` se realiza en las tablas correctas.

3. **Optimizaci√≥n de consultas:**

Al utilizar `INNER JOIN` en consultas con grandes vol√∫menes de datos, es importante optimizar las consultas para un rendimiento √≥ptimo. Utiliza √≠ndices adecuados en las columnas utilizadas para la uni√≥n y aseg√∫rate de que las estad√≠sticas de la base de datos est√©n actualizadas. Esto ayudar√° al motor de SQL Server a generar planes de ejecuci√≥n eficientes y acelerar el tiempo de respuesta de la consulta.

4. **Alias de tabla:**

Considera el uso de alias de tabla para mejorar la legibilidad y la claridad de las consultas. Los alias de tabla proporcionan nombres m√°s cortos y descriptivos para las tablas, lo que facilita la comprensi√≥n de la estructura de la consulta.

Ejemplo:

```
USE Northwind;
GO

SELECT O.OrderID, C.ContactName
FROM Orders AS O
INNER JOIN Customers AS C ON O.CustomerID = C.CustomerID;
```

En este ejemplo, se utilizan alias de tabla "`O`" y "`C`" para las tablas "`Orders`" y "`Customers`", respectivamente. Esto hace que la consulta sea m√°s legible y comprensible.

Al considerar estas recomendaciones al usar `INNER JOIN` en SQL Server, puedes asegurarte de obtener resultados precisos y eficientes en tus consultas. Recuerda que las consideraciones pueden variar seg√∫n la estructura y las necesidades espec√≠ficas de tu base de datos, por lo que es importante analizar y ajustar en consecuencia.

[üîº](#√≠ndice)

---

## **La cl√°usula UNION y UNION ALL**

La cl√°usula `UNION` y `UNION ALL` en SQL Server se utilizan para combinar el resultado de dos o m√°s consultas en un solo conjunto de resultados. Sin embargo, hay una diferencia importante entre ambas cl√°usulas.

La cl√°usula `UNION` combina los resultados de las consultas eliminando cualquier duplicado, es decir, solo muestra los valores √∫nicos en el conjunto de resultados final. Por otro lado, la cl√°usula `UNION ALL` combina los resultados de las consultas sin eliminar duplicados, es decir, muestra todos los valores, incluidos los duplicados, en el conjunto de resultados final.

Aqu√≠ tienes una explicaci√≥n detallada de ambas cl√°usulas, junto con un ejemplo utilizando la base de datos Northwind:

1. **Cl√°usula UNION:**

La cl√°usula `UNION` se utiliza para combinar el resultado de dos o m√°s consultas y mostrar solo los valores √∫nicos en el conjunto de resultados final. Para que funcione correctamente, las consultas involucradas deben tener la misma estructura de columnas.

Sintaxis b√°sica:

```
SELECT columnas
FROM tabla1
UNION
SELECT columnas
FROM tabla2;
```

Ejemplo:

```
USE Northwind;
GO

SELECT CustomerID
FROM Customers
WHERE Country = 'USA'
UNION
SELECT CustomerID
FROM Customers
WHERE City = 'London';
```

En este ejemplo, se combinan los `CustomerID` de los clientes en Estados Unidos y en Londres utilizando la cl√°usula `UNION`. El resultado mostrar√° solo los `CustomerID` √∫nicos que cumplan con las condiciones de ambas consultas.

2. **Cl√°usula UNION ALL:**

La cl√°usula `UNION ALL` se utiliza para combinar el resultado de dos o m√°s consultas y mostrar todos los valores, incluidos los duplicados, en el conjunto de resultados final.

Sintaxis b√°sica:

```
SELECT columnas
FROM tabla1
UNION ALL
SELECT columnas
FROM tabla2;
```

Ejemplo:

```
USE Northwind;
GO

SELECT CustomerID
FROM Customers
WHERE Country = 'USA'
UNION ALL
SELECT CustomerID
FROM Customers
WHERE City = 'London';
```

En este ejemplo, se combinan los `CustomerID` de los clientes en Estados Unidos y en Londres utilizando la cl√°usula `UNION ALL`. El resultado mostrar√° todos los `CustomerID`, incluidos los duplicados, que cumplan con las condiciones de ambas consultas.

Es importante tener en cuenta que la cl√°usula `UNION` y `UNION ALL` requieren que las consultas involucradas tengan la misma estructura de columnas en el mismo orden. Si las consultas no cumplen con esta condici√≥n, se generar√° un error. Adem√°s, es importante considerar el rendimiento y el uso de memoria al elegir entre `UNION` y `UNION ALL`, ya que `UNION` puede implicar una operaci√≥n de eliminaci√≥n de duplicados que puede tener un impacto en el rendimiento.

En resumen, la cl√°usula `UNION` y `UNION ALL` en SQL Server son utilizadas para combinar el resultado de m√∫ltiples consultas en un solo conjunto de resultados. La cl√°usula `UNION` elimina los duplicados, mientras que la cl√°usula `UNION ALL` muestra todos los valores, incluidos los duplicados. El uso de una u otra depende de los requisitos espec√≠ficos de la consulta y del resultado deseado.

[üîº](#√≠ndice)

---

| **Inicio**            | **atr√°s 13**                | **Siguiente 15**                                 |
| --------------------- | --------------------------- | ------------------------------------------------ |
| [üè†](../../README.md) | [‚è™](./13.Transacciones.md) | [‚è©](./15.Funciones_definidas_por_el_Usuario.md) |
