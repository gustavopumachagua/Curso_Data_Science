| **Inicio**            | **atr谩s 15**                                     | **Siguiente 17**     |
| --------------------- | ------------------------------------------------ | -------------------- |
| [](../../README.md) | [](./15.Funciones_definidas_por_el_Usuario.md) | [](./17.Vistas.md) |

---

## **ndice**

| Temario                                                                                         |
| ----------------------------------------------------------------------------------------------- |
| [Introducci贸n](#introducci贸n)                                                                   |
| [Definici贸n y uso de Tabla Temporal en Memoria](#definici贸n-y-uso-de-tabla-temporal-en-memoria) |
| [Definici贸n y uso de Tabla Temporal F铆sica](#definici贸n-y-uso-de-tabla-temporal-f铆sica)         |

---

# **Tablas Temporales**

---

## **Introducci贸n**

Las tablas temporales en SQL Server son tablas que se utilizan para almacenar datos temporales durante la ejecuci贸n de una consulta o de un proceso. Estas tablas son creadas en la base de datos `TempDB` y est谩n disponibles solo durante la sesi贸n de conexi贸n en la que se crean. Las tablas temporales se utilizan principalmente para almacenar datos intermedios o para realizar operaciones complejas en conjunto con otras consultas.

Aqu铆 tienes una explicaci贸n detallada de las tablas temporales, junto con un ejemplo utilizando la base de datos Northwind:

1. Creaci贸n de tablas temporales:

Para crear una tabla temporal, debes seguir los siguientes pasos:

- Especifica el nombre de la tabla `temporal`, que debe comenzar con el s铆mbolo "`#`" o "`##`" (tabla local o tabla global, respectivamente).
- Define la estructura de la tabla, especificando las columnas y los tipos de datos.
- Opcionalmente, puedes agregar restricciones, 铆ndices u otras propiedades a la tabla.

2. Ejemplo de tabla temporal:

Supongamos que queremos realizar una consulta que involucre datos de la tabla "`OrderDetails`" y necesitamos almacenar los resultados intermedios en una tabla temporal. Utilizaremos la base de datos Northwind, donde tenemos la tabla "`OrderDetails`".

Ejemplo de tabla temporal:

```
USE Northwind;
GO

CREATE TABLE #TempOrderDetails
(
    OrderID INT,
    ProductID INT,
    Quantity INT,
    UnitPrice MONEY
);
```

En este ejemplo, creamos una tabla temporal llamada "`#TempOrderDetails`" con las mismas columnas que la tabla "`OrderDetails`". El prefijo "`#`" indica que es una tabla local, que solo est谩 disponible dentro de la sesi贸n de conexi贸n actual.

3. Uso de tablas temporales:

Una vez que has creado una tabla temporal, puedes utilizarla en consultas SQL como cualquier otra tabla. Por ejemplo:

```
INSERT INTO #TempOrderDetails (OrderID, ProductID, Quantity, UnitPrice)
SELECT OrderID, ProductID, Quantity, UnitPrice
FROM OrderDetails
WHERE OrderID IN (SELECT OrderID FROM Orders WHERE CustomerID = 'ALFKI');
```

Esta consulta inserta datos de la tabla "`OrderDetails`" en la tabla temporal "`#TempOrderDetails`" solo para los pedidos realizados por el cliente con el ID '`ALFKI`'.

Luego, puedes realizar otras operaciones o consultas utilizando la tabla temporal como parte de la l贸gica de tu consulta.

4. Eliminaci贸n de tablas temporales:

Las tablas temporales se eliminan autom谩ticamente al finalizar la sesi贸n de conexi贸n en la que se crearon. Sin embargo, tambi茅n puedes eliminar una tabla temporal de forma expl铆cita utilizando la instrucci贸n `DROP TABLE`. Por ejemplo:

`DROP TABLE #TempOrderDetails;`

Esta instrucci贸n elimina la tabla temporal "`#TempOrderDetails`".

Las tablas temporales en SQL Server son 煤tiles cuando necesitas almacenar datos temporales para realizar operaciones complejas o almacenar resultados intermedios durante una sesi贸n de conexi贸n. Puedes utilizar tablas temporales para simplificar consultas complejas, dividir l贸gica en etapas o incluso mejorar el rendimiento al almacenar datos intermedios en lugar de realizar m煤ltiples consultas a tablas reales. Sin embargo, es importante recordar que las tablas temporales est谩n limitadas a la sesi贸n de conexi贸n en la que se crean y no son accesibles desde otras sesiones o conexiones.

[](#铆ndice)

---

## **Definici贸n y uso de Tabla Temporal en Memoria**

Una tabla temporal en memoria en SQL Server es una estructura de datos que se crea y almacena en la memoria principal en lugar de en el disco duro. A diferencia de las tablas temporales tradicionales que se crean en la base de datos `TempDB`, las tablas temporales en memoria se crean en la base de datos actual y se almacenan completamente en la memoria, lo que puede mejorar significativamente el rendimiento de las consultas.

Aqu铆 tienes una explicaci贸n detallada sobre las tablas temporales en memoria, junto con un ejemplo utilizando la base de datos Northwind:

1. Creaci贸n de tablas temporales en memoria:

Para crear una tabla temporal en memoria, debes seguir los siguientes pasos:

- Especifica el nombre de la tabla temporal, que debe comenzar con el s铆mbolo "`#`" o "`##`" (tabla local o tabla global, respectivamente).
- Define la estructura de la tabla, especificando las columnas y los tipos de datos.
- Agrega la cl谩usula "`WITH (MEMORY_OPTIMIZED = ON)`" para indicar que la tabla se almacenar谩 en memoria.

2. Ejemplo de tabla temporal en memoria:

Supongamos que queremos almacenar temporalmente los resultados intermedios de una consulta que involucra la tabla "`OrderDetails`". Utilizaremos la base de datos Northwind, donde tenemos la tabla "`OrderDetails`".

Ejemplo de tabla temporal en memoria:

```
USE Northwind;
GO

CREATE TABLE #TempOrderDetails
(
    OrderID INT,
    ProductID INT,
    Quantity INT,
    UnitPrice MONEY
)
WITH (MEMORY_OPTIMIZED = ON);
```

En este ejemplo, creamos una tabla temporal en memoria llamada "`#TempOrderDetails`" con las mismas columnas que la tabla "`OrderDetails`". El prefijo "`#`" indica que es una tabla local. La cl谩usula "`WITH (MEMORY_OPTIMIZED = ON)`" indica que la tabla se almacenar谩 en memoria.

3. Uso de tablas temporales en memoria:

Una vez que has creado una tabla temporal en memoria, puedes utilizarla en consultas SQL de la misma manera que cualquier otra tabla. Por ejemplo:

```
INSERT INTO #TempOrderDetails (OrderID, ProductID, Quantity, UnitPrice)
SELECT OrderID, ProductID, Quantity, UnitPrice
FROM OrderDetails
WHERE OrderID IN (SELECT OrderID FROM Orders WHERE CustomerID = 'ALFKI');
```

Esta consulta inserta datos de la tabla "`OrderDetails`" en la tabla temporal en memoria "`#TempOrderDetails`" solo para los pedidos realizados por el cliente con el ID '`ALFKI`'.

Luego, puedes realizar otras operaciones o consultas utilizando la tabla temporal en memoria como parte de la l贸gica de tu consulta.

4. Eliminaci贸n de tablas temporales en memoria:

Al igual que con las tablas temporales tradicionales, las tablas temporales en memoria se eliminan autom谩ticamente al finalizar la sesi贸n de conexi贸n en la que se crearon. Sin embargo, tambi茅n puedes eliminar una tabla temporal en memoria de forma expl铆cita utilizando la instrucci贸n `DROP TABLE`. Por ejemplo:

`DROP TABLE #TempOrderDetails;`

Esta instrucci贸n elimina la tabla temporal en memoria "`#TempOrderDetails`".

Las tablas temporales en memoria en SQL Server son una opci贸n eficiente para almacenar datos temporales en la memoria principal y mejorar el rendimiento de las consultas. Al estar completamente en memoria, las operaciones de lectura y escritura en estas tablas son mucho m谩s r谩pidas que en las tablas tradicionales en disco. Sin embargo, ten en cuenta que el uso de tablas temporales en memoria requiere m谩s recursos de memoria y solo est谩n disponibles dentro de la sesi贸n de conexi贸n en la que se crean.

[](#铆ndice)

---

## **Definici贸n y uso de Tabla Temporal F铆sica**

En SQL Server, una tabla temporal f铆sica es una tabla temporal que se crea en la base de datos `TempDB` y se utiliza para almacenar datos temporales durante la ejecuci贸n de una consulta o un proceso. A diferencia de las tablas temporales en memoria, las tablas temporales f铆sicas se almacenan en el disco y pueden ser compartidas y accedidas por m煤ltiples sesiones o conexiones simult谩neamente.

Aqu铆 tienes una explicaci贸n detallada sobre las tablas temporales f铆sicas, junto con un ejemplo utilizando la base de datos Northwind:

1. Creaci贸n de tablas temporales f铆sicas:

Para crear una tabla temporal f铆sica, debes seguir los siguientes pasos:

- Especifica el nombre de la tabla temporal, que debe comenzar con el prefijo "`#`".
- Define la estructura de la tabla, especificando las columnas y los tipos de datos.

2. Ejemplo de tabla temporal f铆sica:

Supongamos que queremos almacenar temporalmente los resultados intermedios de una consulta que involucra la tabla "`OrderDetails`". Utilizaremos la base de datos Northwind, donde tenemos la tabla "`OrderDetails`".

Ejemplo de tabla temporal f铆sica:

```
USE TempDB;
GO

CREATE TABLE #TempOrderDetails
(
    OrderID INT,
    ProductID INT,
    Quantity INT,
    UnitPrice MONEY
);
```

En este ejemplo, creamos una tabla temporal f铆sica llamada "`#TempOrderDetails`" en la base de datos `TempDB` con las mismas columnas que la tabla "`OrderDetails`". El prefijo "`#`" indica que es una tabla temporal.

3. Uso de tablas temporales f铆sicas:

Una vez que has creado una tabla temporal f铆sica, puedes utilizarla en consultas SQL de la misma manera que cualquier otra tabla. Por ejemplo:

```
INSERT INTO #TempOrderDetails (OrderID, ProductID, Quantity, UnitPrice)
SELECT OrderID, ProductID, Quantity, UnitPrice
FROM Northwind.dbo.OrderDetails
WHERE OrderID IN (SELECT OrderID FROM Northwind.dbo.Orders WHERE CustomerID = 'ALFKI');
```

Esta consulta inserta datos de la tabla "`OrderDetails`" en la tabla temporal f铆sica "`#TempOrderDetails`" solo para los pedidos realizados por el cliente con el ID '`ALFKI`'.

Luego, puedes realizar otras operaciones o consultas utilizando la tabla temporal f铆sica como parte de la l贸gica de tu consulta.

4. Eliminaci贸n de tablas temporales f铆sicas:

Las tablas temporales f铆sicas se eliminan autom谩ticamente al finalizar la conexi贸n en la que se crearon. Sin embargo, tambi茅n puedes eliminar una tabla temporal f铆sica de forma expl铆cita utilizando la instrucci贸n `DROP TABLE`. Por ejemplo:

```
USE TempDB;
GO

DROP TABLE #TempOrderDetails;
```

Esta instrucci贸n elimina la tabla temporal f铆sica "`#TempOrderDetails`" de la base de datos `TempDB`.

Las tablas temporales f铆sicas en SQL Server son 煤tiles cuando necesitas compartir y acceder a datos temporales entre m煤ltiples sesiones o conexiones. Aunque pueden ser m谩s lentas que las tablas temporales en memoria debido a la necesidad de acceder al disco, siguen siendo una opci贸n conveniente para el manejo de datos temporales en situaciones donde se requiere compartir datos entre diferentes partes de una aplicaci贸n o proceso.

[](#铆ndice)

---

| **Inicio**            | **atr谩s 15**                                     | **Siguiente 17**     |
| --------------------- | ------------------------------------------------ | -------------------- |
| [](../../README.md) | [](./15.Funciones_definidas_por_el_Usuario.md) | [](./17.Vistas.md) |
