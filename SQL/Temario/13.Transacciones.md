| **Inicio**            | **atr谩s 12**                                  | **Siguiente 14**                       |
| --------------------- | --------------------------------------------- | -------------------------------------- |
| [](../../README.md) | [](./12.Funciones_de_conversion_y_texto.md) | [](./14.JOIN_UNIONS_entre_tablas.md) |

---

## **ndice**

| Temario                                                 |
| ------------------------------------------------------- |
| [Introducci贸n](#introducci贸n)                           |
| [La instrucci贸n BEGIN TRAN](#la-instrucci贸n-begin-tran) |

---

# **Transacciones**

---

## **Introducci贸n**

Las transacciones en SQL Server son una unidad l贸gica de trabajo que agrupa una o m谩s operaciones de base de datos en una secuencia coherente. Una transacci贸n asegura que todas las operaciones se completen correctamente o se deshagan en caso de que ocurra alg煤n error, garantizando as铆 la integridad y consistencia de los datos.

Aqu铆 tienes una explicaci贸n detallada de las transacciones en SQL Server, junto con un ejemplo utilizando la base de datos Northwind:

1. Las transacciones se componen de tres partes esenciales: inicio, operaciones y finalizaci贸n. La secuencia t铆pica de una transacci贸n es la siguiente:

2. Inicio de la transacci贸n (`BEGIN TRANSACTION`): Se inicia una transacci贸n para agrupar las operaciones que se ejecutar谩n dentro de ella. Esto marca el punto de inicio de la transacci贸n.

3. Operaciones de la transacci贸n: Se realizan una o m谩s operaciones de base de datos dentro de la transacci贸n. Estas operaciones pueden incluir inserciones, actualizaciones o eliminaciones de datos.

4. Confirmaci贸n de los cambios (`COMMIT`): Si todas las operaciones de la transacci贸n se han completado correctamente, se confirman los cambios realizados en la base de datos y se hace permanente. Esto marca el punto de finalizaci贸n de la transacci贸n.

5. Deshacer cambios (`ROLLBACK`): Si ocurre alg煤n error durante la ejecuci贸n de las operaciones de la transacci贸n, se realiza un rollback para deshacer todos los cambios realizados hasta el punto de inicio de la transacci贸n. Esto asegura que no se realicen cambios parciales o incorrectos en la base de datos.

Es importante destacar que las transacciones en SQL Server se utilizan en conjunci贸n con el control de concurrencia para garantizar la consistencia de los datos. Durante una transacci贸n, se bloquean los recursos involucrados para evitar que otros usuarios realicen modificaciones simult谩neas hasta que la transacci贸n se complete o se deshaga.

Ejemplo:

```
USE Northwind;
GO

BEGIN TRANSACTION;

UPDATE Customers
SET ContactName = 'John Doe'
WHERE CustomerID = 'ALFKI';

INSERT INTO Orders (CustomerID, OrderDate)
VALUES ('ALFKI', GETDATE());

COMMIT;
```

En este ejemplo, se inicia una transacci贸n utilizando la sentencia `BEGIN TRANSACTION`. Luego se realizan dos operaciones: se actualiza el nombre de contacto de un cliente en la tabla "`Customers`" y se inserta un nuevo pedido en la tabla "`Orders`". Finalmente, se confirman los cambios realizados en la transacci贸n utilizando la sentencia `COMMIT`.

Si hubiera ocurrido alg煤n error durante la ejecuci贸n de las operaciones, se podr铆a haber realizado un `rollback` para deshacer los cambios utilizando la sentencia `ROLLBACK`.

Las transacciones son 煤tiles cuando se necesita asegurar la atomicidad y la integridad de un conjunto de operaciones relacionadas. Al agrupar las operaciones en una transacci贸n, se garantiza que todas se completen o se deshagan de manera coherente, evitando cambios parciales o inconsistentes en la base de datos.

Recuerda que las transacciones est谩n disponibles en SQL Server y son compatibles con otros sistemas de gesti贸n de bases de datos. Sin embargo, las sintaxis y caracter铆sticas espec铆ficas pueden variar entre los diferentes sistemas.

[](#铆ndice)

---

## **La instrucci贸n BEGIN TRAN**

La instrucci贸n "`BEGIN TRAN`" en SQL Server se utiliza para iniciar una transacci贸n. Marca el inicio de una secuencia de operaciones que deben ejecutarse como una unidad l贸gica de trabajo dentro de una transacci贸n.

Aqu铆 tienes una explicaci贸n detallada de la instrucci贸n "`BEGIN TRAN`", junto con un ejemplo utilizando la base de datos Northwind:

La sintaxis b谩sica de la instrucci贸n "`BEGIN TRAN`" es la siguiente:

`BEGIN TRAN [NombreTransaccion]`

- "`NombreTransaccion`" es un identificador opcional que se puede proporcionar para dar un nombre espec铆fico a la transacci贸n. Este nombre puede ser 煤til para identificar y gestionar transacciones en situaciones m谩s complejas.

Ejemplo:

```
USE Northwind;
GO

BEGIN TRAN MiTransaccion;

UPDATE Customers
SET ContactName = 'John Doe'
WHERE CustomerID = 'ALFKI';

INSERT INTO Orders (CustomerID, OrderDate)
VALUES ('ALFKI', GETDATE());
```

En este ejemplo, se utiliza la instrucci贸n "`BEGIN TRAN`" para iniciar una transacci贸n llamada "`MiTransaccion`". Luego se realizan dos operaciones dentro de la transacci贸n: se actualiza el nombre de contacto de un cliente en la tabla "`Customers`" y se inserta un nuevo pedido en la tabla "`Orders`".

Al utilizar "`BEGIN TRAN`", se asegura que todas las operaciones realizadas despu茅s de esta instrucci贸n formen parte de la misma transacci贸n. Esto significa que todas las operaciones deben completarse con 茅xito o deshacerse en caso de error o necesidad de deshacer los cambios.

Es importante tener en cuenta que, para finalizar una transacci贸n, se debe utilizar la instrucci贸n "`COMMIT`" para confirmar los cambios o la instrucci贸n "`ROLLBACK`" para deshacerlos. Sin una de estas instrucciones, la transacci贸n quedar谩 abierta y los cambios no se har谩n permanentes.

La instrucci贸n "`BEGIN TRAN`" es una parte fundamental del control de transacciones en SQL Server. Permite agrupar operaciones relacionadas en una unidad coherente y controlar su ejecuci贸n y resultado como una sola entidad.

Recuerda que las transacciones est谩n disponibles en SQL Server y son compatibles con otros sistemas de gesti贸n de bases de datos. Sin embargo, las sintaxis y caracter铆sticas espec铆ficas pueden variar entre los diferentes sistemas.

[](#铆ndice)

---

| **Inicio**            | **atr谩s 12**                                  | **Siguiente 14**                       |
| --------------------- | --------------------------------------------- | -------------------------------------- |
| [](../../README.md) | [](./12.Funciones_de_conversion_y_texto.md) | [](./14.JOIN_UNIONS_entre_tablas.md) |
