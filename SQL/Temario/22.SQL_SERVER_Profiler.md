| **Inicio**            | **atr谩s 21**                                                   |
| --------------------- | -------------------------------------------------------------- |
| [](../../README.md) | [](./21.Administracion_de_usuarios_roles_shemas_permisos.md) |

---

## **ndice**

| Temario                                                                                                                  |
| ------------------------------------------------------------------------------------------------------------------------ |
| [Introducci贸n](#introducci贸n)                                                                                            |
| [Conociendo la herramienta](#conociendo-la-herramienta)                                                                  |
| [Como monitorear procesos por tiempo de ejecuci贸n](#como-monitorear-procesos-por-tiempo-de-ejecuci贸n)                    |
| [Definiendo templates para monitoreo](#definiendo-templates-para-monitoreo)                                              |
| [Herramientas del men煤, Importaci贸n y exportaci贸n de Trazas](#herramientas-del-men煤-importaci贸n-y-exportaci贸n-de-trazas) |
| [10 Buenas pr谩cticas sobre dise帽o, programaci贸n y seguridad](#10-buenas-pr谩cticas-sobre-dise帽o-programaci贸n-y-seguridad) |

---

# **SQL SERVER Profiler**

---

## **Introducci贸n**

SQL Server Profiler es una herramienta de monitoreo y an谩lisis de rendimiento proporcionada por Microsoft SQL Server. Permite capturar y analizar eventos y actividades que ocurren en una instancia de SQL Server. Con SQL Server Profiler, puedes realizar un seguimiento detallado de las consultas ejecutadas, los procedimientos almacenados llamados, los eventos del sistema y muchas otras actividades relacionadas con la base de datos.

SQL Server Profiler se utiliza principalmente para el an谩lisis de rendimiento y la resoluci贸n de problemas. Puedes utilizarlo para identificar cuellos de botella, optimizar consultas, detectar consultas lentas y comprender el comportamiento del sistema en general. Tambi茅n es una herramienta 煤til para auditar actividades en la base de datos, como seguimiento de cambios, identificaci贸n de problemas de seguridad y an谩lisis de actividad de usuarios.

A continuaci贸n, se muestra un ejemplo de c贸mo utilizar SQL Server Profiler con la base de datos Northwind:

1. **Abrir SQL Server Profiler:**

Abre SQL Server Profiler desde la carpeta "`Herramientas de SQL Server`" en el men煤 de inicio.

2. **Crear un nuevo seguimiento:**

Haz clic en "`Archivo`" y selecciona "`Nuevo seguimiento`". En la ventana emergente, selecciona la instancia de SQL Server que deseas monitorear y elige los eventos que deseas capturar. Puedes seleccionar eventos predefinidos o personalizarlos seg煤n tus necesidades.

3. **Iniciar el seguimiento:**

Haz clic en "`Iniciar`" para comenzar a capturar los eventos. A partir de este punto, SQL Server Profiler registrar谩 todas las actividades seleccionadas en tiempo real.

4. **Realizar acciones en la base de datos:**

Realiza consultas, ejecuta procedimientos almacenados u otras acciones en la base de datos Northwind para capturar los eventos correspondientes.

5. **Analizar los resultados:**

Una vez que hayas finalizado las acciones en la base de datos, puedes detener el seguimiento haciendo clic en "`Detener`". Luego, puedes analizar los resultados en la pesta帽a "`Eventos capturados`" de SQL Server Profiler. Aqu铆 encontrar谩s detalles sobre las consultas ejecutadas, los tiempos de respuesta, los eventos del sistema y otros datos relevantes.

SQL Server Profiler es una herramienta poderosa para el monitoreo y an谩lisis de rendimiento en SQL Server. Te permite comprender el comportamiento de la base de datos, identificar cuellos de botella y mejorar el rendimiento de tus consultas. Adem谩s, puede ayudarte en la resoluci贸n de problemas y en la identificaci贸n de actividades sospechosas o inapropiadas en la base de datos.

Es importante tener en cuenta que SQL Server Profiler puede tener un impacto en el rendimiento del sistema debido a la sobrecarga de captura de eventos. Por lo tanto, se recomienda utilizarlo con precauci贸n en entornos de producci贸n y limitar la cantidad de eventos capturados seg煤n sea necesario.

---

[](#铆ndice)

## **Conociendo la herramienta**

SQL Server Profiler es una herramienta de monitoreo y an谩lisis de rendimiento que permite capturar y analizar eventos y actividades que ocurren en una instancia de SQL Server. Proporciona una interfaz gr谩fica intuitiva que te permite definir y configurar seguimientos personalizados para capturar informaci贸n detallada sobre las consultas, transacciones, eventos del sistema y otras actividades relacionadas con la base de datos.

Aqu铆 tienes un ejemplo de c贸mo utilizar SQL Server Profiler con la base de datos Northwind:

1. **Abrir SQL Server Profiler:**

Inicia SQL Server Profiler desde la carpeta "`Herramientas de SQL Server`" en el men煤 de inicio.

2. **Crear un nuevo seguimiento:**

Haz clic en "`Archivo`" y selecciona "`Nuevo seguimiento`". En la ventana emergente, selecciona la instancia de SQL Server que deseas monitorear y elige los eventos que deseas capturar. Puedes seleccionar eventos predefinidos o personalizarlos seg煤n tus necesidades.

3. **Configurar filtros:**

Puedes aplicar filtros para capturar solo los eventos relevantes. Por ejemplo, puedes filtrar por base de datos, usuario, host o cualquier otra condici贸n espec铆fica. Esto te ayudar谩 a enfocarte en los eventos de inter茅s y reducir la cantidad de datos capturados.

4. **Iniciar el seguimiento:**

Haz clic en "`Iniciar`" para comenzar a capturar los eventos. A partir de este punto, SQL Server Profiler registrar谩 todas las actividades seleccionadas en tiempo real.

5. **Realizar acciones en la base de datos:**

Realiza consultas, ejecuta procedimientos almacenados u otras acciones en la base de datos Northwind para capturar los eventos correspondientes.

6. **Analizar los resultados:**

Una vez que hayas finalizado las acciones en la base de datos, puedes detener el seguimiento haciendo clic en "`Detener`". Luego, puedes analizar los resultados en la pesta帽a "`Eventos capturados`" de SQL Server Profiler. Aqu铆 encontrar谩s detalles sobre las consultas ejecutadas, los tiempos de respuesta, los eventos del sistema y otros datos relevantes.

SQL Server Profiler te brinda una visi贸n detallada del rendimiento y el comportamiento de tu base de datos. Puedes identificar consultas lentas, detectar cuellos de botella, optimizar el rendimiento y solucionar problemas de manera efectiva. Tambi茅n puedes utilizarlo para auditar actividades en la base de datos, monitorear el acceso de usuarios y realizar an谩lisis de rendimiento exhaustivos.

Recuerda que SQL Server Profiler puede tener un impacto en el rendimiento del sistema debido a la sobrecarga de captura de eventos. Por lo tanto, se recomienda utilizarlo con precauci贸n en entornos de producci贸n y limitar la cantidad de eventos capturados seg煤n sea necesario. Adem谩s, aseg煤rate de tener los permisos adecuados para ejecutar SQL Server Profiler, ya que es una herramienta poderosa que puede acceder a informaci贸n confidencial de la base de datos.

En resumen, SQL Server Profiler es una herramienta valiosa para el monitoreo y an谩lisis de rendimiento en SQL Server. Te permite obtener informaci贸n detallada sobre las actividades en la base de datos, lo que facilita la identificaci贸n y soluci贸n de problemas. Su interfaz gr谩fica intuitiva y su capacidad para personalizar los seguimientos lo convierten en una herramienta imprescindible para los administradores de bases de datos.

---

[](#铆ndice)

## **Como monitorear procesos por tiempo de ejecuci贸n**

Para monitorear procesos por tiempo de ejecuci贸n en SQL Server Profiler, puedes utilizar la funci贸n de filtrado y configurar los eventos adecuados. A continuaci贸n, se proporciona una explicaci贸n detallada de c贸mo hacerlo con un ejemplo utilizando la base de datos Northwind:

1. **Abrir SQL Server Profiler:**

Inicia SQL Server Profiler desde la carpeta "`Herramientas de SQL Server`" en el men煤 de inicio.

2. **Crear un nuevo seguimiento:**

Haz clic en "`Archivo`" y selecciona "`Nuevo seguimiento`". En la ventana emergente, selecciona la instancia de SQL Server que deseas monitorear y elige los eventos que deseas capturar.

3. **Configurar eventos y columnas:**

En la pesta帽a "`Eventos seleccionados`", selecciona los eventos que te interesan para monitorear los procesos por tiempo de ejecuci贸n. Algunos eventos relevantes pueden ser "`SQL:BatchCompleted`", "`RPC:Completed`" o "`SP:Completed`". Tambi茅n puedes seleccionar otros eventos adicionales seg煤n tus necesidades.

4. **Configurar columnas adicionales:**

Para monitorear el tiempo de ejecuci贸n, puedes agregar la columna "`Duration`" en la pesta帽a "`Columnas seleccionadas`". Esta columna muestra el tiempo transcurrido en milisegundos para cada evento capturado.

5. **Configurar filtros de duraci贸n:**

Haz clic en el bot贸n "`Filtro`" y en la ventana emergente, selecciona la pesta帽a "`Columnas de duraci贸n`". Aqu铆 puedes definir un filtro para mostrar solo los eventos con una duraci贸n m铆nima o m谩xima espec铆fica. Por ejemplo, puedes establecer un filtro para mostrar solo los eventos que tengan una duraci贸n superior a 1000 milisegundos (1 segundo).

6. **Iniciar el seguimiento:**

Haz clic en "`Iniciar`" para comenzar a capturar los eventos y monitorear los procesos por tiempo de ejecuci贸n.

7. **Realizar acciones en la base de datos:**

Realiza consultas, ejecuta procedimientos almacenados u otras acciones en la base de datos Northwind para capturar los eventos correspondientes.

8. **Analizar los resultados:**

Una vez que hayas finalizado las acciones en la base de datos, puedes detener el seguimiento haciendo clic en "`Detener`". Luego, puedes analizar los resultados en la pesta帽a "`Eventos capturados`" de SQL Server Profiler. Aqu铆 encontrar谩s detalles sobre los eventos capturados, incluido el tiempo de ejecuci贸n de cada proceso.

Al utilizar SQL Server Profiler con la configuraci贸n mencionada, podr谩s monitorear los procesos por tiempo de ejecuci贸n y obtener informaci贸n valiosa sobre el rendimiento de tu base de datos. Esto te permitir谩 identificar consultas lentas o procesos que consumen demasiado tiempo y optimizar su rendimiento.

Recuerda que SQL Server Profiler puede tener un impacto en el rendimiento del sistema debido a la sobrecarga de captura de eventos. Por lo tanto, se recomienda utilizarlo con precauci贸n en entornos de producci贸n y limitar la cantidad de eventos capturados seg煤n sea necesario. Adem谩s, aseg煤rate de tener los permisos adecuados para ejecutar SQL Server Profiler, ya que es una herramienta poderosa que puede acceder a informaci贸n confidencial de la base de datos.

En resumen, utilizando SQL Server Profiler con la configuraci贸n adecuada de eventos, columnas y filtros, puedes monitorear los procesos por tiempo de ejecuci贸n y obtener informaci贸n valiosa sobre el rendimiento de tu base de datos. Esto te ayudar谩 a identificar y solucionar problemas de rendimiento de manera efectiva.

---

[](#铆ndice)

## **Definiendo templates para monitoreo**

En SQL Server, puedes definir templates de monitoreo para capturar y analizar eventos espec铆ficos de manera m谩s eficiente y consistente. Un template es una configuraci贸n predefinida de eventos, columnas y filtros que se puede guardar y reutilizar en diferentes ocasiones. A continuaci贸n, se presenta una explicaci贸n detallada de c贸mo definir y utilizar templates de monitoreo en SQL Server utilizando la base de datos Northwind como ejemplo:

1. **Abrir SQL Server Profiler:**

Inicia SQL Server Profiler desde la carpeta "`Herramientas de SQL Server`" en el men煤 de inicio.

2. **Crear un nuevo seguimiento:**

Haz clic en "`Archivo`" y selecciona "`Nuevo seguimiento`". En la ventana emergente, selecciona la instancia de SQL Server que deseas monitorear.

3. **Configurar eventos y columnas:**

En la pesta帽a "`Eventos seleccionados`", selecciona los eventos y las columnas que deseas capturar en tu template de monitoreo. Por ejemplo, puedes seleccionar los eventos "`SQL:BatchCompleted`", "`RPC:Completed`" y las columnas "`Duration`" y "`TextData`".

4. **Configurar filtros adicionales (opcional):**

Si deseas aplicar filtros adicionales a los eventos capturados, como filtrar por una base de datos espec铆fica o por un usuario determinado, puedes hacerlo en la pesta帽a "`Filtro`".

5. **Guardar el template:**

Haz clic en "`Archivo`" y selecciona "`Guardar como Template`". Elige un nombre descriptivo para el template y gu谩rdalo en una ubicaci贸n conveniente.

6. **Cerrar el seguimiento actual:**

Puedes cerrar el seguimiento actual sin guardar los datos capturados, ya que el template contendr谩 la configuraci贸n deseada.

7. **Utilizar el template en futuros seguimientos:**

Para utilizar el template en futuros seguimientos, abre SQL Server Profiler y haz clic en "`Archivo`" y luego en "`Abrir`". Selecciona "`Template`" en el tipo de archivo y elige el template guardado previamente.

8. **Iniciar el seguimiento:**

Haz clic en "`Iniciar`" para comenzar a capturar los eventos utilizando el template configurado. Realiza acciones en la base de datos Northwind para capturar los eventos correspondientes.

9. **Analizar los resultados:**

Una vez que hayas finalizado las acciones en la base de datos, puedes detener el seguimiento haciendo clic en "`Detener`". Luego, puedes analizar los resultados en la pesta帽a "`Eventos capturados`" de SQL Server Profiler. Aqu铆 encontrar谩s los eventos y columnas definidos en el template, lo que te permitir谩 analizar la informaci贸n capturada de manera m谩s eficiente.

Al utilizar templates de monitoreo, puedes ahorrar tiempo y esfuerzo al configurar repetidamente los eventos, columnas y filtros deseados en cada seguimiento. Adem谩s, la estandarizaci贸n de la configuraci贸n te permite obtener resultados consistentes y comparables en diferentes situaciones.

Recuerda que SQL Server Profiler puede tener un impacto en el rendimiento del sistema debido a la sobrecarga de captura de eventos. Por lo tanto, es importante utilizar los templates de monitoreo de manera selectiva y ajustar la configuraci贸n seg煤n sea necesario para evitar una carga excesiva en el servidor.

En resumen, los templates de monitoreo en SQL Server Profiler te permiten definir configuraciones predefinidas de eventos, columnas y filtros para capturar y analizar de manera eficiente los eventos de tu base de datos. Esto simplifica el proceso de configuraci贸n y te ayuda a obtener informaci贸n relevante de manera m谩s r谩pida y consistente.

---

[](#铆ndice)

## **Herramientas del men煤, Importaci贸n y exportaci贸n de Trazas**

En SQL Server, el men煤 "`Importaci贸n y exportaci贸n de trazas`" proporciona una forma conveniente de importar y exportar archivos de traza generados por SQL Server Profiler. Esto es 煤til cuando deseas compartir trazas con otros usuarios o importar trazas previamente generadas para su an谩lisis. A continuaci贸n, se muestra una explicaci贸n detallada de c贸mo utilizar estas herramientas con la base de datos Northwind como ejemplo:

1. **Abrir SQL Server Profiler:**

Inicia SQL Server Profiler desde la carpeta "Herramientas de SQL Server" en el men煤 de inicio.

2. **Generar una traza:**

Antes de poder importar o exportar una traza, debes generar una utilizando SQL Server Profiler. Configura los eventos, columnas y filtros necesarios para capturar la informaci贸n que deseas. Por ejemplo, puedes seleccionar los eventos "`SQL:BatchCompleted`" y "`RPC:Completed`" y las columnas "`Duration`" y "`TextData`". Inicia la captura de la traza.

3. **Detener la captura de la traza:**

Una vez que hayas realizado las acciones necesarias en la base de datos Northwind, det茅n la captura de la traza en SQL Server Profiler haciendo clic en "`Detener`".

4. **Acceder al men煤 "Importaci贸n y exportaci贸n de trazas":**

Haz clic en "`Archivo`" en la barra de men煤 de SQL Server Profiler y selecciona "`Importaci贸n y exportaci贸n de trazas`". Aparecer谩 una ventana con las opciones disponibles.

5. **Exportar una traza:**

Para exportar una traza generada previamente, selecciona la opci贸n "`Exportar`" en la ventana "`Importaci贸n y exportaci贸n de trazas`". Se abrir谩 un cuadro de di谩logo para seleccionar la traza que deseas exportar y la ubicaci贸n de destino. Elige un nombre para el archivo de traza y haz clic en "`Guardar`". La traza se exportar谩 como un archivo `.trc`.

6. **Importar una traza:**

Para importar una traza previamente generada, selecciona la opci贸n "`Importar`" en la ventana "`Importaci贸n y exportaci贸n de trazas`". Se abrir谩 un cuadro de di谩logo para seleccionar el archivo de traza que deseas importar. Navega hasta el archivo `.trc` y haz clic en "`Abrir`". La traza se importar谩 y estar谩 disponible para su an谩lisis en SQL Server Profiler.

Importar y exportar trazas te permite compartir f谩cilmente archivos de traza con otros usuarios o transferir trazas entre diferentes entornos de SQL Server. Esto es 煤til para colaboraci贸n, an谩lisis de rendimiento y resoluci贸n de problemas.

Es importante tener en cuenta que la importaci贸n y exportaci贸n de trazas requiere permisos adecuados en el servidor SQL Server. Aseg煤rate de tener los permisos necesarios para realizar estas operaciones.

En resumen, la herramienta "`Importaci贸n y exportaci贸n de trazas`" en SQL Server Profiler te permite exportar trazas generadas previamente como archivos .trc y tambi茅n importar trazas para su an谩lisis. Esto facilita la colaboraci贸n y el intercambio de informaci贸n entre diferentes usuarios y entornos de SQL Server.

---

[](#铆ndice)

## **10 Buenas pr谩cticas sobre dise帽o, programaci贸n y seguridad**

Aqu铆 tienes 10 buenas pr谩cticas relacionadas con el dise帽o, programaci贸n y seguridad al utilizar SQL Server Profiler:

1. **Limita el uso de SQL Server Profiler en entornos de producci贸n:** La captura de trazas con SQL Server Profiler puede tener un impacto en el rendimiento del servidor, por lo que se recomienda utilizarlo principalmente en entornos de desarrollo, pruebas o en situaciones espec铆ficas de resoluci贸n de problemas en producci贸n.

2. **Filtra adecuadamente los eventos y columnas:** Configura cuidadosamente los eventos y las columnas que deseas capturar en la traza. Limita la cantidad de eventos y selecciona solo las columnas relevantes para reducir la sobrecarga y mejorar la eficiencia de captura.

3. **Utiliza plantillas personalizadas:** SQL Server Profiler permite crear plantillas personalizadas con la configuraci贸n preferida. Utiliza estas plantillas para evitar la repetici贸n de la configuraci贸n cada vez que inicies una nueva traza.

4. **Limita la duraci贸n de la captura de trazas:** Especifica un tiempo de duraci贸n para la captura de trazas o establece un l铆mite de tama帽o de archivo. Esto ayuda a evitar que las trazas crezcan indefinidamente y consuman recursos innecesarios.

5. **Utiliza trazas filtradas:** Aplica filtros para capturar 煤nicamente los eventos relevantes. Puedes filtrar por aplicaci贸n, base de datos, usuario u otras condiciones que sean importantes para tu an谩lisis.

6. **Asegura la traza:** Para proteger la informaci贸n sensible, aseg煤rate de que las trazas se almacenen en ubicaciones seguras. Limita el acceso a los archivos de traza y considera el uso de cifrado si es necesario.

7. **Evita capturar informaci贸n confidencial:** No captures informaci贸n confidencial, como contrase帽as o datos personales, en las trazas. Aseg煤rate de excluir cualquier informaci贸n sensible de la configuraci贸n de eventos y columnas.

8. **Monitorea el impacto en el rendimiento:** Mant茅n un ojo en el impacto que SQL Server Profiler tiene en el rendimiento del servidor. Si notas una degradaci贸n significativa del rendimiento, ajusta la configuraci贸n de la traza o considera utilizar otras herramientas de monitoreo m谩s ligeras.

9. **Mant茅n un registro de las trazas realizadas:** Lleva un registro de las trazas que has capturado, incluyendo la configuraci贸n utilizada, la fecha y el prop贸sito de la traza. Esto facilita el seguimiento y la referencia futura.

10. **Actual铆zate con las herramientas m谩s recientes:** SQL Server Profiler ha sido reemplazado por Extended Events como la principal herramienta de captura de eventos en versiones m谩s recientes de SQL Server. Considera aprender y utilizar Extended Events para capturar eventos de manera m谩s eficiente y con menos impacto en el rendimiento.

Recuerda que el uso de SQL Server Profiler y otras herramientas de monitoreo debe realizarse de manera responsable y cumpliendo con las pol铆ticas de seguridad y privacidad establecidas en tu organizaci贸n.

---

[](#铆ndice)

| **Inicio**            | **atr谩s 21**                                                   |
| --------------------- | -------------------------------------------------------------- |
| [](../../README.md) | [](./21.Administracion_de_usuarios_roles_shemas_permisos.md) |
